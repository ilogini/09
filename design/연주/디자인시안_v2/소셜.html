<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ì†Œì…œ - ë©ì´ë‘ withbowwow</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/variable/pretendardvariable.min.css">
    <style>
        :root {
            --lime: #C5D900; --lime-dark: #9FB300; --lime-light: rgba(197,217,0,0.10); --lime-glow: rgba(197,217,0,0.25);
            --azure: #0099FF; --azure-dark: #0077CC; --azure-light: rgba(0,153,255,0.08); --azure-glow: rgba(0,153,255,0.20);
            --text-primary: #1A2B3C; --text-secondary: #5C6F82; --text-muted: #94A3B8;
            --bg-base: #F8FCFA; --bg-white: #FFFFFF;
            --glass-bg: rgba(255,255,255,0.65); --glass-bg-heavy: rgba(255,255,255,0.80);
            --glass-border: rgba(197,217,0,0.12); --glass-blur: blur(20px);
            --danger: #EF4444;
            --radius-xl: 28px; --radius-lg: 24px; --radius-md: 20px; --radius-sm: 14px; --radius-xs: 10px;
            --modal-width: 480px; --modal-padding-x: 20px;
            --nav-height: 76px; --header-height: 58px;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        body {
            font-family: 'Pretendard Variable', 'Pretendard', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-base);
            color: var(--text-primary);
            max-width: var(--modal-width);
            margin: 0 auto;
            min-height: 100vh;
            position: relative;
            overflow-x: hidden;
        }

        /* ===== Header (glassmorphism) ===== */
        .header {
            position: sticky; top: 0; z-index: 100;
            background: rgba(255,255,255,0.70);
            backdrop-filter: blur(24px); -webkit-backdrop-filter: blur(24px);
            padding: 12px 20px;
            display: flex; align-items: center; justify-content: space-between;
            height: var(--header-height);
            border-bottom: 1px solid rgba(197,217,0,0.08);
        }
        .header-logo { display: flex; align-items: center; gap: 8px; font-size: 20px; font-weight: 800; color: var(--text-primary); }
        .header-logo .paw-icon { width: 32px; height: 32px; background: var(--lime); border-radius: var(--radius-xs); display: flex; align-items: center; justify-content: center; font-size: 18px; }
        .header-logo em { font-style: normal; color: var(--lime-dark); }
        .header-actions { display: flex; gap: 8px; }
        .header-btn {
            width: 36px; height: 36px; border-radius: 50%; border: none;
            background: var(--glass-bg); backdrop-filter: var(--glass-blur); -webkit-backdrop-filter: var(--glass-blur);
            font-size: 18px; cursor: pointer; display: flex; align-items: center; justify-content: center;
            position: relative; transition: background 0.2s; text-decoration: none; color: var(--text-secondary);
        }
        .header-btn:hover { background: var(--glass-bg-heavy); }
        .header-btn i { width: 20px; height: 20px; }
        .notification-dot { position: absolute; top: 6px; right: 6px; width: 8px; height: 8px; background: var(--danger); border-radius: 50%; border: 2px solid var(--bg-white); }

        /* ===== Social Tabs ===== */
        .social-tabs {
            position: sticky; top: var(--header-height); z-index: 99;
            display: flex;
            background: var(--glass-bg-heavy);
            backdrop-filter: var(--glass-blur); -webkit-backdrop-filter: var(--glass-blur);
            border-bottom: 1px solid var(--glass-border);
        }
        .social-tab {
            flex: 1;
            padding: 14px 0;
            text-align: center;
            font-size: 15px;
            font-weight: 600;
            color: var(--text-muted);
            background: none;
            border: none;
            border-bottom: 3px solid transparent;
            margin-bottom: -1px;
            cursor: pointer;
            font-family: inherit;
            transition: color 0.2s, border-color 0.2s;
        }
        .social-tab:hover { color: var(--text-secondary); }
        .social-tab.active {
            color: var(--text-primary);
            font-weight: 800;
            border-bottom-color: var(--lime);
        }

        /* ===== Content ===== */
        .content { padding-bottom: calc(var(--nav-height) + 20px); }
        .tab-panel { display: none; }
        .tab-panel.active { display: block; }

        /* ===== Section Title ===== */
        .section-title { padding: 24px 16px 12px; display: flex; justify-content: space-between; align-items: center; }
        .section-title h3 { font-size: 17px; font-weight: 700; display: flex; align-items: center; gap: 8px; }
        .section-title h3 i { width: 20px; height: 20px; color: var(--lime-dark); }

        /* ===== Weekly Calendar ===== */
        .calendar-section {
            margin: 16px 16px 0;
            background: var(--glass-bg);
            backdrop-filter: var(--glass-blur); -webkit-backdrop-filter: var(--glass-blur);
            border-radius: var(--radius-md);
            padding: 18px 16px;
            border: 1px solid var(--glass-border);
        }
        .calendar-header {
            display: flex; justify-content: space-between; align-items: center;
            margin-bottom: 16px;
        }
        .calendar-header h4 { font-size: 15px; font-weight: 700; display: flex; align-items: center; gap: 6px; }
        .calendar-header h4 i { width: 18px; height: 18px; color: var(--lime-dark); }
        .calendar-header span { font-size: 12px; color: var(--text-muted); background: var(--lime-light); padding: 4px 10px; border-radius: 20px; }
        .calendar-week {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 4px;
        }
        .calendar-day {
            display: flex; flex-direction: column; align-items: center; gap: 4px;
            padding: 8px 2px 10px;
            border-radius: var(--radius-xs);
            cursor: pointer;
            transition: all 0.2s;
            border: 2px solid transparent;
            position: relative;
        }
        .calendar-day:hover { background: var(--lime-light); }
        .calendar-day.today { border-color: var(--lime); background: var(--lime-light); }
        .calendar-day.selected { background: var(--lime-light); border-color: var(--lime); }
        .calendar-day-label { font-size: 11px; font-weight: 600; color: var(--text-muted); }
        .calendar-day-num { font-size: 13px; font-weight: 700; color: var(--text-primary); }
        .calendar-day.today .calendar-day-label,
        .calendar-day.today .calendar-day-num { color: var(--lime-dark); }
        .calendar-day.selected .calendar-day-label,
        .calendar-day.selected .calendar-day-num { color: var(--lime-dark); }

        .paw-svg-wrap {
            width: 28px;
            height: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* ===== Leaderboard ===== */
        .leaderboard-section {
            margin: 12px 16px 0;
            background: var(--glass-bg);
            backdrop-filter: var(--glass-blur); -webkit-backdrop-filter: var(--glass-blur);
            border-radius: var(--radius-md);
            padding: 18px 16px;
            border: 1px solid var(--glass-border);
        }
        .leaderboard-date {
            font-size: 14px; font-weight: 700; color: var(--text-primary);
            margin-bottom: 6px;
        }
        .leaderboard-sub-header {
            font-size: 12px; font-weight: 600; color: var(--lime-dark);
            margin-bottom: 10px;
            display: flex; align-items: center; gap: 6px;
        }
        .leaderboard-sub-header i { width: 14px; height: 14px; }
        .leaderboard-list { display: flex; flex-direction: column; gap: 6px; }
        .lb-row {
            display: flex; align-items: center; gap: 10px;
            padding: 10px 12px;
            border-radius: var(--radius-xs);
            transition: background 0.15s;
        }
        .lb-row:hover { background: var(--lime-light); }
        .lb-row.me {
            background: var(--lime-light);
            border: 1px solid var(--lime-glow);
        }
        .lb-rank {
            width: 24px; height: 24px;
            border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            font-size: 12px; font-weight: 800;
            flex-shrink: 0;
            background: var(--bg-base); color: var(--text-secondary);
        }
        .lb-rank.r1 { background: #FEF3C7; color: #D97706; }
        .lb-rank.r2 { background: #F3F4F6; color: #6B7280; }
        .lb-rank.r3 { background: #FED7AA; color: #C2410C; }
        .lb-avatar {
            width: 36px; height: 36px; border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            font-size: 18px; flex-shrink: 0;
            box-shadow: 0 0 0 2px var(--lime-glow);
        }
        .lb-info { flex: 1; min-width: 0; }
        .lb-name { font-size: 13px; font-weight: 600; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .lb-me-badge { font-size: 10px; font-weight: 600; color: var(--lime-dark); background: var(--lime-light); padding: 1px 6px; border-radius: 8px; margin-left: 4px; }
        .lb-distance { font-size: 14px; font-weight: 700; color: var(--lime-dark); white-space: nowrap; }
        .lb-distance.zero { color: var(--text-muted); }

        .lb-divider {
            height: 1px; background: var(--glass-border); margin: 12px 0;
        }
        .lb-not-walked-header {
            font-size: 12px; font-weight: 600; color: var(--text-muted);
            margin-bottom: 8px;
            display: flex; align-items: center; gap: 6px;
        }
        .lb-not-walked-header i { width: 14px; height: 14px; }

        /* ===== Friend Buttons ===== */
        .friend-buttons {
            display: flex; gap: 10px;
            margin: 16px;
        }
        .friend-btn {
            flex: 1;
            padding: 14px;
            border-radius: var(--radius-sm);
            font-size: 14px; font-weight: 700;
            font-family: inherit;
            cursor: pointer;
            transition: all 0.2s;
            text-align: center;
            border: none;
            display: flex; align-items: center; justify-content: center; gap: 6px;
        }
        .friend-btn i { width: 16px; height: 16px; }
        .friend-btn.primary {
            background: linear-gradient(135deg, var(--lime), var(--lime-dark));
            color: var(--text-primary);
        }
        .friend-btn.primary:hover { transform: translateY(-1px); }
        .friend-btn.outline {
            background: var(--glass-bg);
            backdrop-filter: var(--glass-blur); -webkit-backdrop-filter: var(--glass-blur);
            color: var(--lime-dark);
            border: 2px solid var(--lime);
        }
        .friend-btn.outline:hover { background: var(--lime-light); transform: translateY(-1px); }

        /* ===== Challenge Tab ===== */
        .create-challenge-btn {
            display: flex; align-items: center; justify-content: center; gap: 8px;
            margin: 16px;
            padding: 16px;
            text-align: center;
            background: linear-gradient(135deg, var(--lime), var(--lime-dark));
            color: var(--text-primary);
            border: none;
            border-radius: var(--radius-md);
            font-size: 16px; font-weight: 700;
            font-family: inherit;
            cursor: pointer;
            transition: all 0.2s;
            width: calc(100% - 32px);
        }
        .create-challenge-btn i { width: 20px; height: 20px; }
        .create-challenge-btn:hover { transform: translateY(-2px); }

        .challenge-card {
            margin: 0 16px 12px;
            background: var(--glass-bg);
            backdrop-filter: var(--glass-blur); -webkit-backdrop-filter: var(--glass-blur);
            border-radius: var(--radius-md);
            padding: 18px 20px;
            border: 1px solid var(--glass-border);
            cursor: pointer;
            transition: all 0.2s;
        }
        .challenge-card:hover { transform: translateY(-1px); background: var(--glass-bg-heavy); }
        .challenge-card-header {
            display: flex; justify-content: space-between; align-items: center;
            margin-bottom: 12px;
        }
        .challenge-card-title { font-size: 16px; font-weight: 700; margin-bottom: 6px; }
        .challenge-card-meta { font-size: 12px; color: var(--text-secondary); margin-bottom: 0; display: flex; align-items: center; gap: 12px; }
        .challenge-type {
            font-size: 11px; font-weight: 600;
            padding: 3px 10px; border-radius: var(--radius-xs);
        }
        .challenge-type.custom { background: var(--azure-light); color: var(--azure-dark); }
        .challenge-type.monthly { background: rgba(245,158,11,0.1); color: #B45309; }
        .challenge-deadline { font-size: 11px; color: var(--danger); font-weight: 700; display: flex; align-items: center; gap: 4px; }
        .challenge-deadline i { width: 12px; height: 12px; }
        .challenge-participants { display: flex; flex-direction: column; gap: 8px; }
        .cp-row { display: flex; align-items: center; gap: 10px; }
        .cp-avatar {
            width: 28px; height: 28px; border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            font-size: 14px; flex-shrink: 0;
            box-shadow: 0 0 0 2px var(--lime-glow);
        }
        .cp-name { font-size: 12px; font-weight: 600; flex: 1; min-width: 0; }
        .cp-dist { font-size: 13px; font-weight: 700; color: var(--lime-dark); white-space: nowrap; }

        /* ===== Monthly Challenges ===== */
        .monthly-challenge-list { padding: 0 16px; display: flex; flex-direction: column; gap: 8px; }
        .monthly-challenge-item {
            display: flex; align-items: center; gap: 12px;
            padding: 14px 16px;
            background: var(--glass-bg);
            backdrop-filter: var(--glass-blur); -webkit-backdrop-filter: var(--glass-blur);
            border-radius: var(--radius-sm);
            border: 1px solid var(--glass-border);
            transition: all 0.2s;
            cursor: pointer;
        }
        .monthly-challenge-item:hover { transform: translateY(-1px); background: var(--glass-bg-heavy); }
        .monthly-challenge-item.move-to-top {
            animation: moveToTop 0.5s ease;
        }
        @keyframes moveToTop {
            0% { opacity: 0.5; transform: translateY(20px); }
            100% { opacity: 1; transform: translateY(0); }
        }
        .mc-icon {
            width: 42px; height: 42px;
            border-radius: 12px;
            display: flex; align-items: center; justify-content: center;
            font-size: 20px; flex-shrink: 0;
        }
        .mc-info { flex: 1; min-width: 0; }
        .mc-name { font-size: 14px; font-weight: 600; margin-bottom: 2px; }
        .mc-goal { font-size: 12px; color: var(--text-secondary); }
        .mc-deadline { font-size: 11px; color: var(--danger); font-weight: 600; margin-top: 2px; display: flex; align-items: center; gap: 4px; }
        .mc-deadline i { width: 12px; height: 12px; }
        .mc-join-btn {
            padding: 8px 18px;
            border-radius: 20px;
            font-size: 12px; font-weight: 600;
            font-family: inherit;
            cursor: pointer;
            transition: all 0.2s;
            white-space: nowrap;
            flex-shrink: 0;
            border: none;
        }
        .mc-join-btn.join {
            background: var(--lime);
            color: var(--text-primary);
        }
        .mc-join-btn.join:hover { background: var(--lime-dark); transform: translateY(-1px); }
        .mc-join-btn.joined {
            background: var(--lime-light);
            color: var(--lime-dark);
            cursor: default;
        }

        /* ===== Friend Challenge List ===== */
        .friend-challenge-list { padding: 0 16px; display: flex; flex-direction: column; gap: 8px; }
        .friend-challenge-item {
            display: flex; align-items: center; gap: 12px;
            padding: 14px 16px;
            background: var(--glass-bg);
            backdrop-filter: var(--glass-blur); -webkit-backdrop-filter: var(--glass-blur);
            border-radius: var(--radius-sm);
            border: 1px solid var(--glass-border);
            transition: all 0.2s;
            cursor: pointer;
        }
        .friend-challenge-item:hover { transform: translateY(-1px); background: var(--glass-bg-heavy); }
        .fc-challenge-icon {
            width: 42px; height: 42px;
            border-radius: 12px;
            display: flex; align-items: center; justify-content: center;
            font-size: 20px; flex-shrink: 0;
        }
        .fc-challenge-info { flex: 1; min-width: 0; }
        .fc-challenge-name { font-size: 14px; font-weight: 600; margin-bottom: 2px; }
        .fc-challenge-meta { font-size: 12px; color: var(--text-secondary); }
        .fc-challenge-deadline { font-size: 11px; color: var(--danger); font-weight: 600; margin-top: 2px; display: flex; align-items: center; gap: 4px; }
        .fc-challenge-deadline i { width: 12px; height: 12px; }
        .fc-challenge-people {
            font-size: 11px; color: var(--text-muted);
            background: var(--lime-light);
            padding: 4px 10px;
            border-radius: 12px;
            white-space: nowrap;
            flex-shrink: 0;
            display: flex; align-items: center; gap: 4px;
        }
        .fc-challenge-people i { width: 12px; height: 12px; }

        /* ===== Challenge Detail Modal ===== */
        .challenge-detail-info {
            background: var(--glass-bg);
            backdrop-filter: var(--glass-blur); -webkit-backdrop-filter: var(--glass-blur);
            border-radius: var(--radius-sm);
            padding: 16px;
            margin-bottom: 20px;
            border: 1px solid var(--glass-border);
        }
        .challenge-detail-info .cd-title {
            font-size: 18px;
            font-weight: 800;
            margin-bottom: 8px;
        }
        .challenge-detail-info .cd-meta {
            display: flex;
            flex-direction: column;
            gap: 6px;
            font-size: 13px;
            color: var(--text-secondary);
        }
        .challenge-detail-info .cd-meta span {
            display: flex;
            align-items: center;
            gap: 6px;
        }
        .challenge-detail-info .cd-meta span i { width: 14px; height: 14px; color: var(--lime-dark); }
        .challenge-detail-info .cd-remaining {
            display: inline-flex; align-items: center; gap: 4px;
            background: #FEE2E2;
            color: var(--danger);
            font-size: 12px;
            font-weight: 700;
            padding: 3px 10px;
            border-radius: var(--radius-xs);
            margin-top: 4px;
        }
        .challenge-detail-info .cd-remaining i { width: 12px; height: 12px; }
        .cd-leaderboard-title {
            font-size: 15px;
            font-weight: 700;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .cd-leaderboard-title i { width: 18px; height: 18px; color: var(--lime-dark); }
        .cd-leaderboard { display: flex; flex-direction: column; gap: 6px; }
        .cd-lb-row {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px 12px;
            border-radius: var(--radius-xs);
            transition: background 0.15s;
        }
        .cd-lb-row.me {
            background: var(--lime-light);
            border: 1px solid var(--lime-glow);
        }
        .cd-lb-rank {
            width: 24px; height: 24px;
            border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            font-size: 12px; font-weight: 800;
            flex-shrink: 0;
            background: var(--bg-base); color: var(--text-secondary);
        }
        .cd-lb-rank.r1 { background: #FEF3C7; color: #D97706; }
        .cd-lb-rank.r2 { background: #F3F4F6; color: #6B7280; }
        .cd-lb-rank.r3 { background: #FED7AA; color: #C2410C; }
        .cd-lb-avatar {
            width: 36px; height: 36px; border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            font-size: 18px; flex-shrink: 0;
            box-shadow: 0 0 0 2px var(--lime-glow);
        }
        .cd-lb-info { flex: 1; min-width: 0; }
        .cd-lb-name { font-size: 13px; font-weight: 600; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .cd-lb-progress { margin-top: 4px; }
        .cd-lb-progress-bar {
            width: 100%; height: 6px;
            background: var(--glass-border);
            border-radius: 3px;
            overflow: hidden;
        }
        .cd-lb-progress-fill {
            height: 100%;
            border-radius: 3px;
            transition: width 0.5s ease;
        }
        .cd-lb-dist { font-size: 14px; font-weight: 700; color: var(--lime-dark); white-space: nowrap; }

        .cd-join-btn {
            width: 100%;
            padding: 14px;
            border-radius: var(--radius-sm);
            font-size: 15px; font-weight: 700;
            font-family: inherit;
            cursor: pointer;
            transition: all 0.2s;
            border: none;
            margin-top: 20px;
        }
        .cd-join-btn.join {
            background: linear-gradient(135deg, var(--lime), var(--lime-dark));
            color: var(--text-primary);
        }
        .cd-join-btn.join:hover { transform: translateY(-1px); }
        .cd-join-btn.joined {
            background: var(--lime-light);
            color: var(--lime-dark);
            cursor: default;
        }

        /* ===== Bottom Nav (glassmorphism) ===== */
        .bottom-nav {
            position: fixed; bottom: 0; left: 50%; transform: translateX(-50%);
            width: 100%; max-width: var(--modal-width); height: var(--nav-height);
            background: rgba(255,255,255,0.70);
            backdrop-filter: blur(24px); -webkit-backdrop-filter: blur(24px);
            border-top: 1px solid rgba(197,217,0,0.08);
            display: flex; align-items: center; justify-content: space-around;
            padding: 0 8px; padding-bottom: env(safe-area-inset-bottom, 0);
            z-index: 200;
        }
        .nav-item {
            display: flex; flex-direction: column; align-items: center; gap: 4px;
            padding: 8px 12px; border: none; background: none;
            cursor: pointer; font-family: inherit; transition: all 0.2s;
            position: relative; min-width: 52px;
            text-decoration: none; color: inherit;
        }
        .nav-icon-wrap { font-size: 22px; line-height: 1; transition: transform 0.2s; display: flex; align-items: center; justify-content: center; }
        .nav-icon-wrap i { width: 24px; height: 24px; color: var(--text-muted); }
        .nav-item .nav-label { font-size: 10px; font-weight: 500; color: var(--text-muted); transition: color 0.2s; }
        .nav-item.active .nav-icon-wrap i { color: var(--lime-dark); }
        .nav-item.active .nav-label { color: var(--lime-dark); font-weight: 600; }
        .nav-item:hover .nav-icon-wrap { transform: translateY(-2px); }
        .nav-item.center-btn { position: relative; top: -14px; }
        .nav-item.center-btn .nav-icon-wrap {
            width: 56px; height: 56px;
            background: linear-gradient(135deg, var(--lime), var(--lime-dark));
            border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            font-size: 26px;
            color: white;
        }
        .nav-item.center-btn .nav-label { color: var(--lime-dark); font-weight: 600; }
        .nav-item.center-btn:hover .nav-icon-wrap { transform: translateY(-4px); }

        /* ===== Modal Overlay ===== */
        .modal-overlay {
            position: fixed; inset: 0; z-index: 300;
            background: rgba(0,0,0,0.4);
            backdrop-filter: blur(4px); -webkit-backdrop-filter: blur(4px);
            display: none; align-items: flex-end; justify-content: center;
            opacity: 0; transition: opacity 0.3s;
        }
        .modal-overlay.show { display: flex; opacity: 1; }
        .modal-frame {
            width: 100%; max-width: var(--modal-width);
            max-height: 85vh;
            background: var(--glass-bg-heavy);
            backdrop-filter: blur(30px); -webkit-backdrop-filter: blur(30px);
            border-radius: var(--radius-xl) var(--radius-xl) 0 0;
            overflow: hidden;
            transform: translateY(100%);
            transition: transform 0.35s cubic-bezier(0.32, 0.72, 0, 1);
            display: flex; flex-direction: column;
            border: 1px solid var(--glass-border);
            border-bottom: none;
        }
        .modal-overlay.show .modal-frame { transform: translateY(0); }
        .modal-header {
            display: flex; align-items: center; justify-content: space-between;
            padding: var(--modal-padding-x);
            padding-top: 20px; padding-bottom: 16px;
            border-bottom: 1px solid var(--glass-border);
            flex-shrink: 0;
        }
        .modal-header h3 { font-size: 18px; font-weight: 800; display: flex; align-items: center; gap: 8px; }
        .modal-header h3 i { width: 20px; height: 20px; color: var(--lime-dark); }
        .modal-close {
            width: 32px; height: 32px; border-radius: 50%;
            border: none; background: var(--lime-light);
            cursor: pointer;
            display: flex; align-items: center; justify-content: center;
            transition: background 0.2s; color: var(--text-secondary);
        }
        .modal-close i { width: 18px; height: 18px; }
        .modal-close:hover { background: var(--lime-glow); }
        .modal-body { flex: 1; overflow-y: auto; padding: var(--modal-padding-x); -webkit-overflow-scrolling: touch; }

        /* ===== Form fields ===== */
        .form-field { margin-bottom: 20px; }
        .form-field label {
            display: block; font-size: 13px; font-weight: 600;
            color: var(--text-secondary); margin-bottom: 8px;
        }
        .form-field input, .form-field textarea, .form-field select {
            width: 100%; padding: 12px 14px;
            border: 1px solid var(--glass-border); border-radius: var(--radius-xs);
            font-size: 14px; font-family: inherit; color: var(--text-primary);
            background: var(--glass-bg); outline: none; transition: border-color 0.2s;
        }
        .form-field input:focus, .form-field textarea:focus { border-color: var(--lime); background: var(--bg-white); }
        .form-submit {
            width: 100%; padding: 14px;
            background: linear-gradient(135deg, var(--lime), var(--lime-dark));
            color: var(--text-primary); border: none; border-radius: var(--radius-sm);
            font-size: 15px; font-weight: 700; font-family: inherit;
            cursor: pointer; transition: all 0.2s;
            margin-top: 8px;
        }
        .form-submit:hover { transform: translateY(-1px); }

        /* ===== Search Modal ===== */
        .search-input-wrap {
            display: flex; gap: 8px; align-items: center;
            margin-bottom: 20px;
        }
        .search-input {
            flex: 1; padding: 12px 14px;
            border: 1px solid var(--glass-border); border-radius: var(--radius-lg);
            font-size: 14px; font-family: inherit; color: var(--text-primary);
            background: var(--glass-bg); outline: none;
            transition: border-color 0.2s;
        }
        .search-input:focus { border-color: var(--lime); background: var(--bg-white); }
        .search-btn {
            width: 44px; height: 44px; border-radius: 50%;
            background: var(--lime); color: var(--text-primary);
            border: none; cursor: pointer;
            display: flex; align-items: center; justify-content: center;
            transition: background 0.2s; flex-shrink: 0;
        }
        .search-btn i { width: 20px; height: 20px; }
        .search-btn:hover { background: var(--lime-dark); }

        .search-result-item {
            display: flex; align-items: center; gap: 12px;
            padding: 12px;
            border-radius: var(--radius-xs);
            transition: background 0.15s;
        }
        .search-result-item:hover { background: var(--lime-light); }
        .sr-avatar {
            width: 40px; height: 40px; border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            font-size: 20px; flex-shrink: 0;
            box-shadow: 0 0 0 2px var(--lime-glow);
        }
        .sr-info { flex: 1; }
        .sr-name { font-size: 14px; font-weight: 600; }
        .sr-sub { font-size: 12px; color: var(--text-muted); }
        .sr-action-btn {
            padding: 7px 16px;
            border-radius: 20px;
            font-size: 12px; font-weight: 600;
            font-family: inherit;
            cursor: pointer;
            border: none;
            transition: all 0.2s;
            flex-shrink: 0;
        }
        .sr-action-btn.add { background: var(--lime); color: var(--text-primary); }
        .sr-action-btn.add:hover { background: var(--lime-dark); }
        .sr-action-btn.added { background: var(--lime-light); color: var(--lime-dark); cursor: default; }

        /* ===== Friend Request ===== */
        .request-item {
            display: flex; align-items: center; gap: 12px;
            padding: 14px 0;
            border-bottom: 1px solid var(--glass-border);
        }
        .request-item:last-child { border-bottom: none; }
        .req-avatar {
            width: 44px; height: 44px; border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            font-size: 22px; flex-shrink: 0;
            box-shadow: 0 0 0 2px var(--lime-glow);
        }
        .req-info { flex: 1; }
        .req-name { font-size: 14px; font-weight: 600; }
        .req-time { font-size: 11px; color: var(--text-muted); margin-top: 2px; }
        .req-actions { display: flex; gap: 6px; flex-shrink: 0; }
        .req-btn {
            width: 36px; height: 36px; border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            border: none; cursor: pointer;
            transition: all 0.2s;
        }
        .req-btn i { width: 16px; height: 16px; }
        .req-btn.accept { background: var(--lime); color: var(--text-primary); }
        .req-btn.accept:hover { background: var(--lime-dark); transform: scale(1.1); }
        .req-btn.reject { background: var(--bg-base); color: var(--text-muted); }
        .req-btn.reject:hover { background: #FEE2E2; color: var(--danger); transform: scale(1.1); }

        /* ===== Friend invite checkbox ===== */
        .friend-check-list { display: flex; flex-direction: column; gap: 8px; }
        .friend-check-item {
            display: flex; align-items: center; gap: 12px;
            padding: 10px 12px;
            border-radius: var(--radius-xs);
            cursor: pointer;
            transition: background 0.15s;
            border: 1px solid var(--glass-border);
        }
        .friend-check-item:hover { background: var(--lime-light); }
        .friend-check-item.checked { background: var(--lime-light); border-color: var(--lime); }
        .fc-avatar {
            width: 32px; height: 32px; border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            font-size: 16px; flex-shrink: 0;
            box-shadow: 0 0 0 2px var(--lime-glow);
        }
        .fc-name { flex: 1; font-size: 13px; font-weight: 600; }
        .fc-check {
            width: 22px; height: 22px; border-radius: 50%;
            border: 2px solid var(--glass-border);
            display: flex; align-items: center; justify-content: center;
            color: var(--bg-white); transition: all 0.2s; flex-shrink: 0;
        }
        .fc-check i { width: 14px; height: 14px; }
        .friend-check-item.checked .fc-check { background: var(--lime); border-color: var(--lime); }

        /* ===== Animations ===== */
        .animate-in { animation: fadeInUp 0.4s ease forwards; opacity: 0; }
        @keyframes fadeInUp { from{opacity:0;transform:translateY(16px)} to{opacity:1;transform:translateY(0)} }
        .animate-in:nth-child(1) { animation-delay: 0.05s; }
        .animate-in:nth-child(2) { animation-delay: 0.1s; }
        .animate-in:nth-child(3) { animation-delay: 0.15s; }
        .animate-in:nth-child(4) { animation-delay: 0.2s; }
        .animate-in:nth-child(5) { animation-delay: 0.25s; }
        .animate-in:nth-child(6) { animation-delay: 0.3s; }

        .tab-panel.active > * {
            animation: fadeInUp 0.35s ease forwards;
            opacity: 0;
        }
        .tab-panel.active > *:nth-child(1) { animation-delay: 0.03s; }
        .tab-panel.active > *:nth-child(2) { animation-delay: 0.06s; }
        .tab-panel.active > *:nth-child(3) { animation-delay: 0.09s; }
        .tab-panel.active > *:nth-child(4) { animation-delay: 0.12s; }
        .tab-panel.active > *:nth-child(5) { animation-delay: 0.15s; }
        .tab-panel.active > *:nth-child(6) { animation-delay: 0.18s; }
        .tab-panel.active > *:nth-child(7) { animation-delay: 0.21s; }
        .tab-panel.active > *:nth-child(8) { animation-delay: 0.24s; }
        .tab-panel.active > *:nth-child(9) { animation-delay: 0.27s; }
        .tab-panel.active > *:nth-child(10) { animation-delay: 0.30s; }

        /* ===== Toast ===== */
        .toast-el { position: fixed; bottom: 90px; left: 50%; transform: translateX(-50%) translateY(12px); background: rgba(26,43,60,0.88); backdrop-filter: blur(8px); -webkit-backdrop-filter: blur(8px); color: white; padding: 10px 20px; border-radius: var(--radius-lg); font-size: 13px; font-weight: 500; z-index: 500; opacity: 0; transition: all 0.25s; pointer-events: none; white-space: nowrap; max-width: 90%; }
        .toast-el.show { opacity: 1; transform: translateX(-50%) translateY(0); }

        /* ===== Empty state ===== */
        .empty-state { text-align: center; padding: 40px 20px; color: var(--text-muted); }
        .empty-state .icon { font-size: 48px; margin-bottom: 12px; display: flex; align-items: center; justify-content: center; }
        .empty-state .icon i { width: 48px; height: 48px; color: var(--text-muted); }
        .empty-state p { font-size: 14px; }
    </style>
</head>
<body>

    <!-- Header -->
    <header class="header">
        <div class="header-logo">
            <div class="paw-icon">&#x1F43E;</div>
            <span>ë©ì´<em>ë‘</em></span>
        </div>
        <div class="header-actions">
            <a class="header-btn" href="ì•Œë¦¼.html" aria-label="ì•Œë¦¼"><i data-lucide="bell"></i><span class="notification-dot"></span></a>
            <a class="header-btn" href="ì„¤ì •.html" aria-label="ì„¤ì •"><i data-lucide="settings"></i></a>
        </div>
    </header>

    <!-- Social Tabs -->
    <div class="social-tabs">
        <button class="social-tab active" data-tab="leaderboard">ë¦¬ë”ë³´ë“œ</button>
        <button class="social-tab" data-tab="challenge">ì±Œë¦°ì§€</button>
    </div>

    <!-- Main Content -->
    <main class="content">

        <!-- ==================== TAB 1: ë¦¬ë”ë³´ë“œ ==================== -->
        <div class="tab-panel active" id="tab-leaderboard">

            <!-- Weekly Calendar -->
            <div class="calendar-section">
                <div class="calendar-header">
                    <h4><i data-lucide="calendar"></i> ì£¼ê°„ ì‚°ì±… í˜„í™©</h4>
                    <span id="weekLabel">2ì›” 3ì£¼ì°¨</span>
                </div>
                <div class="calendar-week" id="calendarWeek">
                    <!-- Populated by JS -->
                </div>
            </div>

            <!-- Leaderboard -->
            <div class="leaderboard-section" id="leaderboardSection">
                <!-- Populated by JS -->
            </div>

            <!-- Friend Buttons -->
            <div class="friend-buttons">
                <button class="friend-btn primary" onclick="openModal('friendSearchModal')"><i data-lucide="search"></i> ì¹œêµ¬ì°¾ê¸°</button>
                <button class="friend-btn outline" onclick="openModal('friendRequestModal')"><i data-lucide="mail"></i> ì¹œêµ¬ìš”ì²­ <span id="requestBadge" style="background:var(--danger);color:white;font-size:10px;padding:1px 6px;border-radius:10px;margin-left:4px;">2</span></button>
            </div>
        </div>

        <!-- ==================== TAB 2: ì±Œë¦°ì§€ ==================== -->
        <div class="tab-panel" id="tab-challenge">

            <!-- Create Challenge Button -->
            <button class="create-challenge-btn" onclick="openModal('challengeCreateModal')">
                <i data-lucide="plus-circle"></i> ì±Œë¦°ì§€ ë§Œë“¤ê¸°
            </button>

            <!-- My Active Challenges (friend challenges) -->
            <div class="section-title"><h3><i data-lucide="flame"></i> ë‚´ê°€ ì°¸ê°€ ì¤‘ì¸ ì±Œë¦°ì§€</h3></div>

            <div class="friend-challenge-list" id="friendChallengeList">
                <!-- Populated by JS -->
            </div>

            <!-- Monthly Challenges -->
            <div class="section-title"><h3><i data-lucide="trophy"></i> ì´ë‹¬ì˜ ì±Œë¦°ì§€</h3></div>

            <div class="monthly-challenge-list" id="monthlyChallengeList">
                <!-- Populated by JS -->
            </div>

            <div style="height: 16px;"></div>
        </div>

    </main>

    <!-- Bottom Nav -->
    <nav class="bottom-nav">
        <a class="nav-item" href="ë©ì´ë‘_ë©”ì¸í˜ì´ì§€_ì‹œì•ˆ.html"><span class="nav-icon-wrap"><i data-lucide="home"></i></span><span class="nav-label">í™ˆ</span></a>
        <a class="nav-item active" href="ì†Œì…œ.html"><span class="nav-icon-wrap"><i data-lucide="users"></i></span><span class="nav-label">ì†Œì…œ</span></a>
        <button class="nav-item center-btn" onclick="location.href='ë©ì´ë‘_ë©”ì¸í˜ì´ì§€_ì‹œì•ˆ.html'"><span class="nav-icon-wrap">ğŸ¾</span><span class="nav-label">ì‚°ì±…</span></button>
        <a class="nav-item" href="ë­í‚¹.html"><span class="nav-icon-wrap"><i data-lucide="trophy"></i></span><span class="nav-label">ë­í‚¹</span></a>
        <a class="nav-item" href="ë§ˆì´í˜ì´ì§€.html"><span class="nav-icon-wrap"><i data-lucide="user"></i></span><span class="nav-label">MY</span></a>
    </nav>

    <!-- ===== Modal: ì¹œêµ¬ì°¾ê¸° ===== -->
    <div class="modal-overlay" id="friendSearchModal">
        <div class="modal-frame">
            <div class="modal-header">
                <h3><i data-lucide="search"></i> ì¹œêµ¬ì°¾ê¸°</h3>
                <button class="modal-close" onclick="closeModal('friendSearchModal')"><i data-lucide="x"></i></button>
            </div>
            <div class="modal-body">
                <div class="search-input-wrap">
                    <input type="text" class="search-input" id="friendSearchInput" placeholder="#íƒœê·¸ ë˜ëŠ” ê°•ì•„ì§€ ì´ë¦„ìœ¼ë¡œ ê²€ìƒ‰...">
                    <button class="search-btn" onclick="searchFriend()"><i data-lucide="search"></i></button>
                </div>
                <div id="searchResults">
                    <div class="empty-state">
                        <div class="icon"><i data-lucide="search"></i></div>
                        <p>#íƒœê·¸(ì˜ˆ: #1234) ë˜ëŠ”<br>ê°•ì•„ì§€ ì´ë¦„ìœ¼ë¡œ ê²€ìƒ‰í•´ë³´ì„¸ìš”</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ===== Modal: ì¹œêµ¬ìš”ì²­ ===== -->
    <div class="modal-overlay" id="friendRequestModal">
        <div class="modal-frame">
            <div class="modal-header">
                <h3><i data-lucide="mail"></i> ì¹œêµ¬ìš”ì²­</h3>
                <button class="modal-close" onclick="closeModal('friendRequestModal')"><i data-lucide="x"></i></button>
            </div>
            <div class="modal-body" id="friendRequestList">
                <div class="request-item" id="req-1">
                    <div class="req-avatar" style="background:linear-gradient(135deg,#FEE2E2,#FCA5A5);">&#x1F9AE;</div>
                    <div class="req-info">
                        <div class="req-name">ë°”ë‘‘ì´#4567</div>
                        <div class="req-time">2ì‹œê°„ ì „</div>
                    </div>
                    <div class="req-actions">
                        <button class="req-btn accept" onclick="acceptRequest('req-1')" title="ìˆ˜ë½"><i data-lucide="check"></i></button>
                        <button class="req-btn reject" onclick="rejectRequest('req-1')" title="ê±°ì ˆ"><i data-lucide="x"></i></button>
                    </div>
                </div>
                <div class="request-item" id="req-2">
                    <div class="req-avatar" style="background:linear-gradient(135deg,#DBEAFE,#93C5FD);">&#x1F431;</div>
                    <div class="req-info">
                        <div class="req-name">ë‚˜ë¹„#8901</div>
                        <div class="req-time">1ì¼ ì „</div>
                    </div>
                    <div class="req-actions">
                        <button class="req-btn accept" onclick="acceptRequest('req-2')" title="ìˆ˜ë½"><i data-lucide="check"></i></button>
                        <button class="req-btn reject" onclick="rejectRequest('req-2')" title="ê±°ì ˆ"><i data-lucide="x"></i></button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ===== Modal: ì±Œë¦°ì§€ ë§Œë“¤ê¸° ===== -->
    <div class="modal-overlay" id="challengeCreateModal">
        <div class="modal-frame">
            <div class="modal-header">
                <h3><i data-lucide="award"></i> ì±Œë¦°ì§€ ë§Œë“¤ê¸°</h3>
                <button class="modal-close" onclick="closeModal('challengeCreateModal')"><i data-lucide="x"></i></button>
            </div>
            <div class="modal-body">
                <div class="form-field">
                    <label>ì±Œë¦°ì§€ ì´ë¦„</label>
                    <input type="text" placeholder="ì˜ˆ: ìš°ë¦¬ ë™ë„¤ ì‚°ì±… ì±Œë¦°ì§€">
                </div>
                <div class="form-field">
                    <label>ëª©í‘œ ê±°ë¦¬ (km)</label>
                    <input type="number" min="1" placeholder="ì˜ˆ: 10" value="10">
                </div>
                <div class="form-field">
                    <label>ì‹œì‘ì¼</label>
                    <input type="date" value="2026-02-19">
                </div>
                <div class="form-field">
                    <label>ì¢…ë£Œì¼</label>
                    <input type="date" value="2026-02-28">
                </div>
                <div class="form-field">
                    <label>ì¹œêµ¬ ì´ˆëŒ€</label>
                    <div class="friend-check-list">
                        <div class="friend-check-item" onclick="toggleFriendCheck(this)">
                            <div class="fc-avatar" style="background:linear-gradient(135deg,#FEF3C7,#FDE68A);">&#x1F415;</div>
                            <div class="fc-name">ì´ˆì½”#1234</div>
                            <div class="fc-check"><i data-lucide="check"></i></div>
                        </div>
                        <div class="friend-check-item" onclick="toggleFriendCheck(this)">
                            <div class="fc-avatar" style="background:linear-gradient(135deg,#FCE7F3,#F9A8D4);">&#x1F429;</div>
                            <div class="fc-name">ë‹¬ì´#5678</div>
                            <div class="fc-check"><i data-lucide="check"></i></div>
                        </div>
                        <div class="friend-check-item" onclick="toggleFriendCheck(this)">
                            <div class="fc-avatar" style="background:linear-gradient(135deg,#DBEAFE,#93C5FD);">&#x1F415;</div>
                            <div class="fc-name">ë½€ì‚#3456</div>
                            <div class="fc-check"><i data-lucide="check"></i></div>
                        </div>
                        <div class="friend-check-item" onclick="toggleFriendCheck(this)">
                            <div class="fc-avatar" style="background:linear-gradient(135deg,#EDE9FE,#DDD6FE);">&#x1F415;</div>
                            <div class="fc-name">ëª½ì´#7890</div>
                            <div class="fc-check"><i data-lucide="check"></i></div>
                        </div>
                        <div class="friend-check-item" onclick="toggleFriendCheck(this)">
                            <div class="fc-avatar" style="background:linear-gradient(135deg,#FEE2E2,#FCA5A5);">&#x1F415;</div>
                            <div class="fc-name">ì´ˆë¡±#2345</div>
                            <div class="fc-check"><i data-lucide="check"></i></div>
                        </div>
                    </div>
                </div>
                <button class="form-submit" onclick="createChallenge()">ì±Œë¦°ì§€ ì‹œì‘í•˜ê¸°</button>
            </div>
        </div>
    </div>

    <!-- ===== Modal: ì±Œë¦°ì§€ ìƒì„¸ ===== -->
    <div class="modal-overlay" id="challengeDetailModal">
        <div class="modal-frame">
            <div class="modal-header">
                <h3><i data-lucide="trophy"></i> ì±Œë¦°ì§€ ìƒì„¸</h3>
                <button class="modal-close" onclick="closeModal('challengeDetailModal')"><i data-lucide="x"></i></button>
            </div>
            <div class="modal-body" id="challengeDetailBody">
                <!-- Populated by JS -->
            </div>
        </div>
    </div>

    <!-- Toast -->
    <div class="toast-el" id="toastEl"></div>

    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.min.js"></script>
    <script>
    // ============================================================
    //  ë©ì´ë‘ ì†Œì…œ - ë¦¬ë”ë³´ë“œ & ì±Œë¦°ì§€ (Design System v2)
    // ============================================================

    // Initialize Lucide icons
    document.addEventListener('DOMContentLoaded', function() {
        lucide.createIcons();
    });

    // Re-initialize Lucide icons after dynamic content changes
    function refreshIcons() {
        lucide.createIcons();
    }

    // ===== Data =====
    var friendColors = ['#EF4444', '#0099FF', '#F59E0B', '#8B5CF6', '#EC4899', '#C5D900'];

    var friends = [
        { name: '\uCD08\uCF54#1234', emoji: '\u{1F415}', bg: 'linear-gradient(135deg,#FEF3C7,#FDE68A)' },
        { name: '\uB2EC\uC774#5678', emoji: '\u{1F429}', bg: 'linear-gradient(135deg,#FCE7F3,#F9A8D4)' },
        { name: '\uCF69\uC774#9012', emoji: '\u{1F436}', bg: 'linear-gradient(135deg,#D1FAE5,#A7F3D0)', isMe: true },
        { name: '\uBF40\uC0DF#3456', emoji: '\u{1F415}', bg: 'linear-gradient(135deg,#DBEAFE,#93C5FD)' },
        { name: '\uBABD\uC774#7890', emoji: '\u{1F415}', bg: 'linear-gradient(135deg,#EDE9FE,#DDD6FE)' },
        { name: '\uCD08\uB871#2345', emoji: '\u{1F415}', bg: 'linear-gradient(135deg,#FEE2E2,#FCA5A5)' }
    ];

    // Weekly walk data (distance in km for each friend, indexed by day 0-6 = Mon-Sun)
    var weekData = [
        // Mon
        { walked: [
            { idx: 0, dist: 3.5 }, { idx: 1, dist: 2.8 }, { idx: 2, dist: 1.9 }, { idx: 3, dist: 1.2 }
        ]},
        // Tue
        { walked: [
            { idx: 0, dist: 4.0 }, { idx: 2, dist: 2.5 }, { idx: 4, dist: 1.8 }
        ]},
        // Wed
        { walked: [
            { idx: 0, dist: 4.2 }, { idx: 1, dist: 3.8 }, { idx: 2, dist: 2.1 }, { idx: 3, dist: 1.5 }, { idx: 5, dist: 0.8 }
        ]},
        // Thu (today)
        { walked: [
            { idx: 0, dist: 4.2 }, { idx: 1, dist: 3.8 }, { idx: 2, dist: 2.1 }, { idx: 3, dist: 1.5 }
        ]},
        // Fri
        { walked: [] },
        // Sat
        { walked: [] },
        // Sun
        { walked: [] }
    ];

    var dayLabels = ['\uC6D4', '\uD654', '\uC218', '\uBAA9', '\uAE08', '\uD1A0', '\uC77C'];
    var dayDates = [17, 18, 19, 20, 21, 22, 23]; // Feb 3rd week
    var todayIndex = 3; // Thursday
    var selectedDay = todayIndex;

    // ===== SVG Paw Generator =====
    function generatePawSVG(walkedFriends) {
        var count = walkedFriends.length;

        var toe1 = '<ellipse cx="28" cy="20" rx="11" ry="13"';
        var toe2 = '<ellipse cx="55" cy="13" rx="10" ry="12"';
        var toe3 = '<ellipse cx="82" cy="20" rx="11" ry="13"';
        var pad  = '<path d="M28,48 Q20,68 35,84 Q45,95 55,95 Q65,95 75,84 Q90,68 82,48 Q75,38 55,36 Q35,38 28,48Z"';

        var parts = [toe1, toe2, toe3, pad];
        var defaultColor = '#D1D5DB';

        if (count === 0) {
            var svg = '<svg viewBox="0 0 110 100" width="28" height="28" xmlns="http://www.w3.org/2000/svg">';
            parts.forEach(function(p) {
                svg += p + ' fill="' + defaultColor + '" opacity="0.4"/>';
            });
            svg += '</svg>';
            return svg;
        }

        if (count >= 4) {
            var svg = '<svg viewBox="0 0 110 100" width="28" height="28" xmlns="http://www.w3.org/2000/svg">';
            svg += '<defs><linearGradient id="pawRainbow" x1="0%" y1="0%" x2="100%" y2="100%">';
            svg += '<stop offset="0%" stop-color="#EF4444"/>';
            svg += '<stop offset="25%" stop-color="#F59E0B"/>';
            svg += '<stop offset="50%" stop-color="#C5D900"/>';
            svg += '<stop offset="75%" stop-color="#0099FF"/>';
            svg += '<stop offset="100%" stop-color="#8B5CF6"/>';
            svg += '</linearGradient></defs>';
            parts.forEach(function(p) {
                svg += p + ' fill="url(#pawRainbow)"/>';
            });
            svg += '</svg>';
            return svg;
        }

        var colors = [];
        for (var i = 0; i < count && i < 4; i++) {
            colors.push(friendColors[walkedFriends[i].idx % friendColors.length]);
        }

        var svg = '<svg viewBox="0 0 110 100" width="28" height="28" xmlns="http://www.w3.org/2000/svg">';
        parts.forEach(function(p, idx) {
            if (idx < colors.length) {
                svg += p + ' fill="' + colors[idx] + '"/>';
            } else {
                svg += p + ' fill="' + defaultColor + '" opacity="0.3"/>';
            }
        });
        svg += '</svg>';
        return svg;
    }

    // ===== Calendar Rendering =====
    function renderCalendar() {
        var container = document.getElementById('calendarWeek');
        container.innerHTML = '';

        dayLabels.forEach(function(label, i) {
            var dayEl = document.createElement('div');
            dayEl.className = 'calendar-day';
            if (i === todayIndex) dayEl.classList.add('today');
            if (i === selectedDay) dayEl.classList.add('selected');
            dayEl.onclick = function() { selectDay(i); };

            var data = weekData[i];
            var pawSvg = generatePawSVG(data.walked);

            dayEl.innerHTML =
                '<span class="calendar-day-label">' + label + '</span>' +
                '<span class="calendar-day-num">' + dayDates[i] + '</span>' +
                '<span class="paw-svg-wrap">' + pawSvg + '</span>';

            container.appendChild(dayEl);
        });
    }

    function selectDay(index) {
        selectedDay = index;
        renderCalendar();
        renderLeaderboard();
    }

    // ===== Leaderboard Rendering =====
    function renderLeaderboard() {
        var section = document.getElementById('leaderboardSection');
        var data = weekData[selectedDay];
        var dateStr = '2\uC6D4 ' + dayDates[selectedDay] + '\uC77C (' + dayLabels[selectedDay] + ')';

        var walked = data.walked.slice().sort(function(a, b) { return b.dist - a.dist; });
        var walkedIndices = new Set(walked.map(function(w) { return w.idx; }));

        var notWalked = friends.filter(function(f, i) { return !walkedIndices.has(i); }).map(function(f) {
            var origIdx = friends.indexOf(f);
            return { idx: origIdx, dist: 0 };
        });

        var html = '<div class="leaderboard-date">' + dateStr + '</div>';

        if (walked.length > 0) {
            html += '<div class="leaderboard-sub-header"><i data-lucide="footprints"></i> \uC0B0\uCC45\uD55C \uC0AC\uB78C (' + walked.length + '\uBA85)</div>';
            html += '<div class="leaderboard-list">';
            walked.forEach(function(w, rank) {
                var f = friends[w.idx];
                var rankClass = '';
                if (rank === 0) rankClass = 'r1';
                else if (rank === 1) rankClass = 'r2';
                else if (rank === 2) rankClass = 'r3';
                var meClass = f.isMe ? ' me' : '';
                var meBadge = f.isMe ? ' <span class="lb-me-badge">\uB098</span>' : '';

                html += '<div class="lb-row' + meClass + '">';
                html += '<div class="lb-rank ' + rankClass + '">' + (rank + 1) + '</div>';
                html += '<div class="lb-avatar" style="background:' + f.bg + '">' + f.emoji + '</div>';
                html += '<div class="lb-info"><div class="lb-name">' + f.name + meBadge + '</div></div>';
                html += '<div class="lb-distance">' + w.dist.toFixed(1) + 'km</div>';
                html += '</div>';
            });
            html += '</div>';
        } else {
            html += '<div class="empty-state" style="padding:20px 0;">';
            html += '<div class="icon"><i data-lucide="moon"></i></div>';
            html += '<p>\uC544\uC9C1 \uC544\uBB34\uB3C4 \uC0B0\uCC45\uD558\uC9C0 \uC54A\uC558\uC5B4\uC694</p>';
            html += '</div>';
        }

        if (notWalked.length > 0) {
            html += '<div class="lb-divider"></div>';
            html += '<div class="lb-not-walked-header"><i data-lucide="cloud-moon"></i> \uC544\uC9C1 \uC0B0\uCC45 \uC804 (' + notWalked.length + '\uBA85)</div>';
            html += '<div class="leaderboard-list">';
            notWalked.forEach(function(w) {
                var f = friends[w.idx];
                var meClass = f.isMe ? ' me' : '';
                var meBadge = f.isMe ? ' <span class="lb-me-badge">\uB098</span>' : '';

                html += '<div class="lb-row' + meClass + '" style="opacity:0.6;">';
                html += '<div class="lb-rank">-</div>';
                html += '<div class="lb-avatar" style="background:' + f.bg + '">' + f.emoji + '</div>';
                html += '<div class="lb-info"><div class="lb-name">' + f.name + meBadge + '</div></div>';
                html += '<div class="lb-distance zero">0.0km</div>';
                html += '</div>';
            });
            html += '</div>';
        }

        section.innerHTML = html;
        refreshIcons();
    }

    // ===== Monthly Challenges =====
    var monthlyChallenges = [
        { name: '\uAC00\uBCBC\uC6B4 \uC0B0\uCC45', goal: '5km', goalNum: 5, icon: '\u{1F6B6}', bg: '#D1FAE5', participants: 1247, joined: true, endDate: '2026-02-28' },
        { name: '\uB9E4\uC77C \uAC77\uAE30', goal: '10km', goalNum: 10, icon: '\u{1F463}', bg: '#DBEAFE', participants: 892, joined: true, endDate: '2026-02-28' },
        { name: '\uD65C\uBC1C\uD55C \uC0B0\uCC45\uB7EC', goal: '20km', goalNum: 20, icon: '\u{1F3C3}', bg: '#FEF3C7', participants: 634, joined: false, endDate: '2026-02-28' },
        { name: '\uAFB8\uC900\uD55C \uBC1C\uAC78\uC74C', goal: '30km', goalNum: 30, icon: '\u{1F4AA}', bg: '#EDE9FE', participants: 421, joined: false, endDate: '2026-02-28' },
        { name: '\uD55C\uAC15 \uD55C\uBC14\uD034', goal: '42km', goalNum: 42, icon: '\u{1F30A}', bg: '#DBEAFE', participants: 289, joined: false, endDate: '2026-02-28' },
        { name: '\uC0B0\uCC45 \uB9E4\uB2C8\uC544', goal: '50km', goalNum: 50, icon: '\u{1F525}', bg: '#FEE2E2', participants: 187, joined: false, endDate: '2026-02-28' },
        { name: '\uB3C4\uC2DC \uD0D0\uD5D8\uAC00', goal: '75km', goalNum: 75, icon: '\u{1F9ED}', bg: '#FCE7F3', participants: 98, joined: false, endDate: '2026-02-28' },
        { name: '\uB9C8\uB77C\uD1A0\uB108\uC758 \uAE38', goal: '100km', goalNum: 100, icon: '\u{1F3C5}', bg: '#FEF3C7', participants: 52, joined: false, endDate: '2026-02-28' },
        { name: '\uC6B8\uD2B8\uB77C \uC6CC\uCEE4', goal: '150km', goalNum: 150, icon: '\u26A1', bg: '#EDE9FE', participants: 21, joined: false, endDate: '2026-02-28' },
        { name: '\uC804\uC124\uC758 \uC0B0\uCC45\uC655', goal: '200km', goalNum: 200, icon: '\u{1F451}', bg: 'linear-gradient(135deg,#FEF3C7,#FDE68A)', participants: 7, joined: false, endDate: '2026-02-28' }
    ];

    var monthlyChallengeLeaderboards = {};
    monthlyChallenges.forEach(function(c, i) {
        var participants = [];
        var sampleNames = [
            { name: '\uCF69\uC774#9012', emoji: '\u{1F436}', bg: 'linear-gradient(135deg,#D1FAE5,#A7F3D0)', isMe: true },
            { name: '\uCD08\uCF54#1234', emoji: '\u{1F415}', bg: 'linear-gradient(135deg,#FEF3C7,#FDE68A)' },
            { name: '\uB2EC\uC774#5678', emoji: '\u{1F429}', bg: 'linear-gradient(135deg,#FCE7F3,#F9A8D4)' },
            { name: '\uBF40\uC0DF#3456', emoji: '\u{1F415}', bg: 'linear-gradient(135deg,#DBEAFE,#93C5FD)' },
            { name: '\uBABD\uC774#7890', emoji: '\u{1F415}', bg: 'linear-gradient(135deg,#EDE9FE,#DDD6FE)' }
        ];
        var numShow = Math.min(5, 3 + Math.floor(Math.random() * 3));
        for (var j = 0; j < numShow; j++) {
            var dist = Math.round((c.goalNum * (0.3 + Math.random() * 0.7)) * 10) / 10;
            participants.push({
                name: sampleNames[j].name,
                emoji: sampleNames[j].emoji,
                bg: sampleNames[j].bg,
                isMe: sampleNames[j].isMe || false,
                dist: dist
            });
        }
        participants.sort(function(a, b) { return b.dist - a.dist; });
        monthlyChallengeLeaderboards[i] = participants;
    });

    function getDaysRemaining(endDate) {
        var today = new Date(2026, 1, 19);
        var end = new Date(endDate);
        var diff = Math.ceil((end - today) / (1000 * 60 * 60 * 24));
        return diff > 0 ? diff : 0;
    }

    function renderMonthlyChallenges() {
        var list = document.getElementById('monthlyChallengeList');
        var sorted = monthlyChallenges.map(function(c, i) { return { challenge: c, origIndex: i }; });
        sorted.sort(function(a, b) {
            if (a.challenge.joined && !b.challenge.joined) return -1;
            if (!a.challenge.joined && b.challenge.joined) return 1;
            return 0;
        });

        var html = '';
        sorted.forEach(function(item) {
            var c = item.challenge;
            var i = item.origIndex;
            var joinedClass = c.joined ? 'joined' : 'join';
            var joinedText = c.joined ? '\u2705 \uCC38\uAC00\uC911' : '\uCC38\uAC00';
            var daysLeft = getDaysRemaining(c.endDate);

            html += '<div class="monthly-challenge-item animate-in" onclick="openChallengeDetail(\'monthly\', ' + i + ')" data-index="' + i + '">';
            html += '<div class="mc-icon" style="background:' + c.bg + ';">' + c.icon + '</div>';
            html += '<div class="mc-info">';
            html += '<div class="mc-name">' + c.name + '</div>';
            html += '<div class="mc-goal">' + c.goal + '/\uC6D4</div>';
            html += '<div class="mc-deadline"><i data-lucide="clock"></i> D-' + daysLeft + '</div>';
            html += '</div>';
            html += '<button class="mc-join-btn ' + joinedClass + '" data-index="' + i + '" onclick="event.stopPropagation(); toggleJoinChallenge(this, ' + i + ')">' + joinedText + '</button>';
            html += '</div>';
        });
        list.innerHTML = html;
        refreshIcons();
    }

    function toggleJoinChallenge(btn, index) {
        var c = monthlyChallenges[index];
        if (c.joined) {
            return;
        }
        c.joined = true;
        c.participants++;
        btn.className = 'mc-join-btn joined';
        btn.textContent = '\u2705 \uCC38\uAC00\uC911';
        toast('\u{1F389} "' + c.name + '" \uCC4C\uB9B0\uC9C0\uC5D0 \uCC38\uAC00\uD588\uC2B5\uB2C8\uB2E4!');

        setTimeout(function() {
            renderMonthlyChallenges();
            var items = document.querySelectorAll('.monthly-challenge-item');
            items.forEach(function(item) {
                if (parseInt(item.dataset.index) === index) {
                    item.classList.add('move-to-top');
                }
            });
        }, 300);
    }

    // ===== Friend Challenges =====
    var friendChallenges = [
        {
            name: '\uD55C\uAC15 \uB2EC\uB9AC\uAE30',
            goal: '30km',
            goalNum: 30,
            icon: '\u{1F3C3}',
            bg: '#DBEAFE',
            endDate: '2026-02-28',
            participants: [
                { name: '\uCD08\uCF54#1234', emoji: '\u{1F415}', bg: 'linear-gradient(135deg,#FEF3C7,#FDE68A)', dist: 18.5 },
                { name: '\uCF69\uC774#9012', emoji: '\u{1F436}', bg: 'linear-gradient(135deg,#D1FAE5,#A7F3D0)', isMe: true, dist: 12.3 },
                { name: '\uB2EC\uC774#5678', emoji: '\u{1F429}', bg: 'linear-gradient(135deg,#FCE7F3,#F9A8D4)', dist: 8.7 }
            ]
        },
        {
            name: '\uB9E4\uC77C \uC544\uCE68 \uC0B0\uCC45',
            goal: '20km',
            goalNum: 20,
            icon: '\u{1F305}',
            bg: '#FEF3C7',
            endDate: '2026-02-28',
            participants: [
                { name: '\uCF69\uC774#9012', emoji: '\u{1F436}', bg: 'linear-gradient(135deg,#D1FAE5,#A7F3D0)', isMe: true, dist: 14.2 },
                { name: '\uBF40\uC0DF#3456', emoji: '\u{1F415}', bg: 'linear-gradient(135deg,#DBEAFE,#93C5FD)', dist: 9.8 }
            ]
        }
    ];

    function renderFriendChallenges() {
        var list = document.getElementById('friendChallengeList');
        if (friendChallenges.length === 0) {
            list.innerHTML = '<div class="empty-state"><div class="icon"><i data-lucide="footprints"></i></div><p>\uCC38\uAC00 \uC911\uC778 \uCE5C\uAD6C \uCC4C\uB9B0\uC9C0\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4</p></div>';
            refreshIcons();
            return;
        }
        var html = '';
        friendChallenges.forEach(function(c, i) {
            var daysLeft = getDaysRemaining(c.endDate);
            html += '<div class="friend-challenge-item animate-in" onclick="openChallengeDetail(\'friend\', ' + i + ')">';
            html += '<div class="fc-challenge-icon" style="background:' + c.bg + ';">' + c.icon + '</div>';
            html += '<div class="fc-challenge-info">';
            html += '<div class="fc-challenge-name">' + c.name + '</div>';
            html += '<div class="fc-challenge-meta">' + c.goal + '/\uC6D4</div>';
            html += '<div class="fc-challenge-deadline"><i data-lucide="clock"></i> D-' + daysLeft + '</div>';
            html += '</div>';
            html += '<div class="fc-challenge-people"><i data-lucide="users"></i> ' + c.participants.length + '\uBA85</div>';
            html += '</div>';
        });
        list.innerHTML = html;
        refreshIcons();
    }

    // ===== Challenge Detail Modal =====
    function openChallengeDetail(type, index) {
        var body = document.getElementById('challengeDetailBody');
        var challenge, leaderboard, goalNum, isJoined;

        if (type === 'monthly') {
            var c = monthlyChallenges[index];
            challenge = {
                name: c.name,
                goal: c.goal + '/\uC6D4',
                icon: c.icon,
                endDate: c.endDate,
                participants: c.participants
            };
            goalNum = c.goalNum;
            isJoined = c.joined;
            leaderboard = monthlyChallengeLeaderboards[index] || [];
        } else {
            var c = friendChallenges[index];
            challenge = {
                name: c.name,
                goal: c.goal + '/\uC6D4',
                icon: c.icon,
                endDate: c.endDate,
                participants: c.participants.length
            };
            goalNum = c.goalNum;
            isJoined = true;
            leaderboard = c.participants.slice().sort(function(a, b) { return b.dist - a.dist; });
        }

        var daysLeft = getDaysRemaining(challenge.endDate);
        var startDate = '2026-02-01';
        var endDate = challenge.endDate;

        var html = '';
        html += '<div class="challenge-detail-info">';
        html += '<div class="cd-title">' + challenge.icon + ' ' + challenge.name + '</div>';
        html += '<div class="cd-meta">';
        html += '<span><i data-lucide="target"></i> \uBAA9\uD45C: ' + challenge.goal + '</span>';
        html += '<span><i data-lucide="calendar"></i> \uAE30\uAC04: ' + startDate + ' ~ ' + endDate + '</span>';
        html += '<span><i data-lucide="users"></i> \uCC38\uAC00\uC790: ' + (typeof challenge.participants === 'number' ? challenge.participants.toLocaleString() + '\uBA85' : challenge.participants + '\uBA85') + '</span>';
        html += '</div>';
        html += '<div class="cd-remaining"><i data-lucide="clock"></i> D-' + daysLeft + '</div>';
        html += '</div>';

        html += '<div class="cd-leaderboard-title"><i data-lucide="trophy"></i> \uCC38\uAC00\uC790 \uB9AC\uB354\uBCF4\uB4DC</div>';
        html += '<div class="cd-leaderboard">';
        leaderboard.forEach(function(p, rank) {
            var rankClass = '';
            if (rank === 0) rankClass = 'r1';
            else if (rank === 1) rankClass = 'r2';
            else if (rank === 2) rankClass = 'r3';
            var meClass = p.isMe ? ' me' : '';
            var meBadge = p.isMe ? ' <span class="lb-me-badge">\uB098</span>' : '';
            var pct = Math.min(100, Math.round((p.dist / goalNum) * 100));
            var barColor = p.isMe ? 'var(--lime)' : 'var(--azure)';

            html += '<div class="cd-lb-row' + meClass + '">';
            html += '<div class="cd-lb-rank ' + rankClass + '">' + (rank + 1) + '</div>';
            html += '<div class="cd-lb-avatar" style="background:' + p.bg + '">' + p.emoji + '</div>';
            html += '<div class="cd-lb-info">';
            html += '<div class="cd-lb-name">' + p.name + meBadge + '</div>';
            html += '<div class="cd-lb-progress"><div class="cd-lb-progress-bar"><div class="cd-lb-progress-fill" style="width:' + pct + '%;background:' + barColor + '"></div></div></div>';
            html += '</div>';
            html += '<div class="cd-lb-dist">' + p.dist.toFixed(1) + 'km</div>';
            html += '</div>';
        });
        html += '</div>';

        var joinBtnClass = isJoined ? 'cd-join-btn joined' : 'cd-join-btn join';
        var joinBtnText = isJoined ? '\u2705 \uCC38\uAC00\uC911' : '\uCC38\uAC00\uD558\uAE30';
        var joinOnclick = '';
        if (!isJoined && type === 'monthly') {
            joinOnclick = ' onclick="joinFromDetail(' + index + ')"';
        }
        html += '<button class="' + joinBtnClass + '"' + joinOnclick + '>' + joinBtnText + '</button>';

        body.innerHTML = html;
        openModal('challengeDetailModal');
        refreshIcons();
    }

    function joinFromDetail(index) {
        var c = monthlyChallenges[index];
        if (c.joined) return;
        c.joined = true;
        c.participants++;
        toast('\u{1F389} "' + c.name + '" \uCC4C\uB9B0\uC9C0\uC5D0 \uCC38\uAC00\uD588\uC2B5\uB2C8\uB2E4!');
        renderMonthlyChallenges();
        var btn = document.querySelector('#challengeDetailBody .cd-join-btn');
        if (btn) {
            btn.className = 'cd-join-btn joined';
            btn.textContent = '\u2705 \uCC38\uAC00\uC911';
            btn.onclick = null;
        }
    }

    // ===== Tab Switching =====
    var tabs = document.querySelectorAll('.social-tab');
    var panels = document.querySelectorAll('.tab-panel');

    tabs.forEach(function(tab) {
        tab.addEventListener('click', function() {
            var target = tab.dataset.tab;
            tabs.forEach(function(t) { t.classList.remove('active'); });
            tab.classList.add('active');
            panels.forEach(function(p) {
                p.classList.remove('active');
                if (p.id === 'tab-' + target) {
                    p.classList.add('active');
                }
            });
        });
    });

    // ===== Modal =====
    function openModal(id) {
        var modal = document.getElementById(id);
        modal.style.display = 'flex';
        requestAnimationFrame(function() {
            requestAnimationFrame(function() { modal.classList.add('show'); });
        });
        document.body.style.overflow = 'hidden';
    }
    function closeModal(id) {
        var modal = document.getElementById(id);
        modal.classList.remove('show');
        setTimeout(function() { modal.style.display = 'none'; document.body.style.overflow = ''; }, 350);
    }
    document.querySelectorAll('.modal-overlay').forEach(function(overlay) {
        overlay.addEventListener('click', function(e) {
            if (e.target === this) closeModal(this.id);
        });
    });

    // ===== Friend Search =====
    var searchDatabase = [
        { name: '\uB8E8\uBE44#5555', emoji: '\u{1F436}', bg: 'linear-gradient(135deg,#FEE2E2,#FCA5A5)', sub: '\uD3EC\uBA54\uB77C\uB2C8\uC548' },
        { name: '\uD558\uB8E8#6666', emoji: '\u{1F9AE}', bg: 'linear-gradient(135deg,#DBEAFE,#93C5FD)', sub: '\uC2DC\uBC14 \uC774\uB204' },
        { name: '\uB450\uBD80#7777', emoji: '\u{1F429}', bg: 'linear-gradient(135deg,#FEF3C7,#FDE68A)', sub: '\uB9D0\uD2F0\uC988' },
        { name: '\uCF54\uCF54#8888', emoji: '\u{1F415}', bg: 'linear-gradient(135deg,#D1FAE5,#A7F3D0)', sub: '\uB798\uBE0C\uB77C\uB3C4 \uB9AC\uD2B8\uB9AC\uBC84' },
        { name: '\uCD08\uCF54#1234', emoji: '\u{1F415}', bg: 'linear-gradient(135deg,#FEF3C7,#FDE68A)', sub: '\uACE8\uB4E0 \uB9AC\uD2B8\uB9AC\uBC84 (\uC774\uBBF8 \uCE5C\uAD6C)' },
    ];

    function searchFriend() {
        var query = document.getElementById('friendSearchInput').value.trim().toLowerCase();
        var results = document.getElementById('searchResults');

        if (!query) {
            results.innerHTML = '<div class="empty-state"><div class="icon"><i data-lucide="search"></i></div><p>#\uD0DC\uADF8(\uC608: #1234) \uB610\uB294<br>\uAC15\uC544\uC9C0 \uC774\uB984\uC73C\uB85C \uAC80\uC0C9\uD574\uBCF4\uC138\uC694</p></div>';
            refreshIcons();
            return;
        }

        var matched = searchDatabase.filter(function(s) {
            return s.name.toLowerCase().includes(query);
        });

        if (matched.length === 0) {
            results.innerHTML = '<div class="empty-state"><div class="icon"><i data-lucide="frown"></i></div><p>"' + query + '" \uAC80\uC0C9 \uACB0\uACFC\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4</p></div>';
            refreshIcons();
            return;
        }

        var html = '';
        matched.forEach(function(s) {
            var isAlreadyFriend = s.sub.includes('\uC774\uBBF8 \uCE5C\uAD6C');
            html += '<div class="search-result-item">';
            html += '<div class="sr-avatar" style="background:' + s.bg + '">' + s.emoji + '</div>';
            html += '<div class="sr-info"><div class="sr-name">' + s.name + '</div><div class="sr-sub">' + s.sub + '</div></div>';
            if (isAlreadyFriend) {
                html += '<button class="sr-action-btn added">\u2705 \uCE5C\uAD6C</button>';
            } else {
                html += '<button class="sr-action-btn add" onclick="addFriend(this)">\uCE5C\uAD6C \uCD94\uAC00</button>';
            }
            html += '</div>';
        });
        results.innerHTML = html;
        refreshIcons();
    }

    document.getElementById('friendSearchInput').addEventListener('keydown', function(e) {
        if (e.key === 'Enter') searchFriend();
    });

    function addFriend(btn) {
        btn.className = 'sr-action-btn added';
        btn.textContent = '\u2709 \uC694\uCCAD \uBCF4\uB0C4';
        btn.onclick = null;
        toast('\u{1F4E8} \uCE5C\uAD6C \uC694\uCCAD\uC744 \uBCF4\uB0C8\uC2B5\uB2C8\uB2E4!');
    }

    // ===== Friend Requests =====
    function acceptRequest(id) {
        var item = document.getElementById(id);
        item.style.transition = 'all 0.3s';
        item.style.opacity = '0';
        item.style.transform = 'translateX(50px)';
        setTimeout(function() {
            item.innerHTML = '<div style="text-align:center;padding:10px;color:var(--lime-dark);font-size:13px;font-weight:600;">\u2705 \uCE5C\uAD6C\uAC00 \uB418\uC5C8\uC2B5\uB2C8\uB2E4!</div>';
            item.style.opacity = '1';
            item.style.transform = 'translateX(0)';
        }, 300);
        toast('\u{1F389} \uCE5C\uAD6C \uC694\uCCAD\uC744 \uC218\uB77D\uD588\uC2B5\uB2C8\uB2E4!');
        updateRequestBadge();
    }

    function rejectRequest(id) {
        var item = document.getElementById(id);
        item.style.transition = 'all 0.3s';
        item.style.opacity = '0';
        item.style.transform = 'translateX(-50px)';
        setTimeout(function() {
            item.innerHTML = '<div style="text-align:center;padding:10px;color:var(--text-muted);font-size:13px;">\uC694\uCCAD\uC744 \uAC70\uC808\uD588\uC2B5\uB2C8\uB2E4</div>';
            item.style.opacity = '1';
            item.style.transform = 'translateX(0)';
        }, 300);
        updateRequestBadge();
    }

    var requestCount = 2;
    function updateRequestBadge() {
        requestCount--;
        var badge = document.getElementById('requestBadge');
        if (requestCount <= 0) {
            badge.style.display = 'none';
        } else {
            badge.textContent = requestCount;
        }
    }

    // ===== Challenge Create =====
    function createChallenge() {
        var checked = document.querySelectorAll('.friend-check-item.checked');
        if (checked.length === 0) {
            toast('\u26A0\uFE0F \uCE5C\uAD6C\uB97C 1\uBA85 \uC774\uC0C1 \uCD08\uB300\uD574\uC8FC\uC138\uC694');
            return;
        }
        toast('\u{1F389} \uCC4C\uB9B0\uC9C0\uAC00 \uC0DD\uC131\uB418\uC5C8\uC2B5\uB2C8\uB2E4!');
        closeModal('challengeCreateModal');
    }

    function toggleFriendCheck(item) {
        item.classList.toggle('checked');
    }

    // ===== Toast =====
    var toastTimer;
    function toast(msg) {
        var el = document.getElementById('toastEl');
        el.textContent = msg;
        el.classList.add('show');
        clearTimeout(toastTimer);
        toastTimer = setTimeout(function() { el.classList.remove('show'); }, 2500);
    }

    // ===== Init =====
    renderCalendar();
    renderLeaderboard();
    renderMonthlyChallenges();
    renderFriendChallenges();
    </script>
</body>
</html>
