# 공구모아 — 프론트엔드 개발 지침

---

## 1. 기술 스택

| 구분 | 기술 | 버전(권장) |
|------|------|-----------|
| 프레임워크 | Next.js (App Router) | 14+ |
| 언어 | TypeScript | 5+ |
| 스타일링 | Tailwind CSS | 3+ |
| UI 컴포넌트 | shadcn/ui | 최신 |
| 상태관리 | Zustand | 4+ |
| API 통신 | Axios + TanStack Query | 5+ |
| 폼 처리 | React Hook Form + Zod | — |
| 날짜 처리 | date-fns | — |
| 캘린더 | FullCalendar 또는 react-day-picker | — |
| 아이콘 | Lucide React | — |
| 배포 | Vercel | — |

---

## 2. 프로젝트 구조

```
src/
├── app/                    # Next.js App Router 페이지
│   ├── (public)/           # 비로그인 접근 가능 페이지
│   │   ├── page.tsx        # 메인 홈 (P01)
│   │   ├── login/          # 로그인 (P06)
│   │   ├── signup/         # 회원가입 (P02~P05)
│   │   ├── gonggu/         # 공구 탐색 (P08~P16)
│   │   ├── influencer/     # 인플루언서 탐색 (P18~P22)
│   │   ├── search/         # 검색 (P23~P26)
│   │   └── ...
│   ├── (buyer)/            # 구매자 전용 (로그인 필수)
│   │   ├── mypage/         # 마이페이지 (P35~P52)
│   │   ├── calendar/       # 공구 캘린더 (P41~P44)
│   │   ├── feed/           # 구독 피드 (P39)
│   │   └── ...
│   ├── (influencer)/       # 인플루언서 전용
│   │   ├── dashboard/      # 대시보드 (P53)
│   │   ├── manage/         # 공구 관리 (P54~P62)
│   │   └── ...
│   ├── admin/              # 관리자 전용
│   │   ├── dashboard/      # 관리자 대시보드 (P78~P80)
│   │   └── ...
│   └── layout.tsx          # 루트 레이아웃
├── components/
│   ├── ui/                 # shadcn/ui 기본 컴포넌트
│   ├── common/             # 공통 컴포넌트 (C01~C12)
│   │   ├── Header.tsx      # GNB
│   │   ├── Footer.tsx
│   │   ├── BottomNav.tsx   # 모바일 하단 네비게이션
│   │   ├── GongguCard.tsx  # 공구 카드
│   │   ├── InfluencerCard.tsx
│   │   ├── ReviewCard.tsx
│   │   └── EmptyState.tsx
│   ├── gonggu/             # 공구 관련 컴포넌트
│   ├── influencer/         # 인플루언서 관련 컴포넌트
│   └── admin/              # 관리자 관련 컴포넌트
├── lib/
│   ├── api/                # API 호출 함수
│   │   ├── client.ts       # Axios 인스턴스 설정
│   │   ├── auth.ts         # 인증 API
│   │   ├── gonggu.ts       # 공구 API
│   │   ├── influencer.ts   # 인플루언서 API
│   │   └── user.ts         # 사용자 API
│   ├── hooks/              # 커스텀 훅
│   └── utils/              # 유틸리티 함수
├── stores/                 # Zustand 상태 저장소
│   ├── authStore.ts        # 인증 상태
│   └── uiStore.ts          # UI 상태 (모달, 토스트 등)
├── types/                  # TypeScript 타입 정의
│   ├── gonggu.ts
│   ├── user.ts
│   └── influencer.ts
└── styles/
    └── globals.css         # Tailwind 기본 + 글로벌 스타일
```

---

## 3. 백엔드 API 통신 규칙

### 3.1 API 서버 정보

- 백엔드: FastAPI (Python)
- API 문서: `{API_SERVER}/docs` (Swagger 자동 생성)
- 모든 API는 REST 방식, JSON 형식

### 3.2 인증 방식

```
1. 로그인 → POST /api/auth/login → Access Token + Refresh Token 발급
2. API 요청 시 → Authorization: Bearer {access_token} 헤더 포함
3. 토큰 만료 시 → POST /api/auth/refresh → 새 토큰 발급
4. 소셜 로그인 → OAuth2 콜백 처리 후 동일하게 JWT 발급
```

### 3.3 API 호출 패턴

```typescript
// lib/api/client.ts — Axios 인스턴스
const apiClient = axios.create({
  baseURL: process.env.NEXT_PUBLIC_API_URL,
  headers: { 'Content-Type': 'application/json' },
});

// 인터셉터로 토큰 자동 첨부 + 만료 시 갱신 처리
```

### 3.4 에러 처리

백엔드에서 내려오는 에러 형식:

```json
{
  "detail": "에러 메시지",
  "code": "ERROR_CODE"
}
```

HTTP 상태 코드 기준:
- `401`: 토큰 만료/미인증 → 로그인 페이지로 이동
- `403`: 권한 없음 → 접근 불가 안내
- `404`: 리소스 없음 → 404 페이지
- `422`: 입력값 유효성 에러 → 폼 에러 표시

---

## 4. 반응형 디자인 기준

### 4.1 Breakpoint

```css
/* Tailwind 기본 breakpoint 사용 */
sm: 640px    /* 모바일 가로 */
md: 768px    /* 태블릿 */
lg: 1024px   /* 데스크톱 */
xl: 1280px   /* 대형 데스크톱 (max-width 컨테이너) */
```

### 4.2 레이아웃 원칙

- **모바일 퍼스트**: 기본 스타일은 모바일, `md:`, `lg:`로 확장
- 모바일: 1열, 하단 네비게이션
- 태블릿: 2열 그리드
- 데스크톱: 최대 4열, `max-width: 1280px` 중앙 정렬
- 최소 터치 타겟: 44x44px (`min-h-11 min-w-11`)

---

## 5. 주요 페이지별 구현 참고

### 5.1 메인 홈 (P01)

- Hero 배너: 슬라이드 (Swiper 또는 Embla Carousel)
- 공구 카드: 남은 시간 실시간 카운트다운 (클라이언트 타이머)
- 무한 스크롤 또는 페이지네이션

### 5.2 공구 상세 (P16)

- 이미지 갤러리: 슬라이드 + 줌
- 남은 시간 타이머: 서버 시간 기준으로 동기화
- **"구매하러 가기" 버튼**: 외부 링크 이동 전 안내 팝업 표시
- 클릭 시 백엔드 트래킹 API 호출 후 외부 URL로 이동

```typescript
// 외부 링크 클릭 처리 예시
const handleBuyClick = async (gongguId: string, trackingUrl: string) => {
  await apiClient.post(`/api/tracking/click`, { gonggu_id: gongguId });
  window.open(trackingUrl, '_blank');
};
```

### 5.3 캘린더 (P41~P43)

- 월간/주간/일간 뷰 전환
- 색상 구분: 진행중(초록), 오픈 예정(파랑), 마감 임박(빨강)
- 캘린더 라이브러리에 공구 일정 데이터 바인딩

### 5.4 구독 피드 (P39)

- 인플루언서 프로필 가로 스크롤 (상단)
- 공구 카드 리스트 (무한 스크롤)
- 필터: 전체 / 진행중 / 오픈예정 / 마감임박

---

## 6. SEO 처리

공구 탐색 플랫폼이므로 SEO가 중요하다.

| 페이지 | 렌더링 방식 | 이유 |
|--------|-----------|------|
| 메인 홈 | SSR 또는 ISR | 실시간 인기 공구 노출 |
| 공구 상세 | SSR | 공구별 고유 메타 태그 필요 |
| 인플루언서 프로필 | SSR | 검색 엔진 노출 |
| 카테고리 목록 | ISR (Revalidate) | 자주 변경되지만 실시간까진 불필요 |
| 마이페이지/관리자 | CSR | 로그인 필수, SEO 불필요 |

각 페이지에 `generateMetadata`로 동적 메타 태그 설정:

```typescript
export async function generateMetadata({ params }): Promise<Metadata> {
  const gonggu = await getGonggu(params.id);
  return {
    title: `${gonggu.title} - 공구모아`,
    description: gonggu.description,
    openGraph: { images: [gonggu.thumbnail] },
  };
}
```

---

## 7. PWA 설정

초기 모바일 대응은 PWA로 진행한다.

- `next-pwa` 패키지 사용
- `manifest.json`: 앱 이름, 아이콘, 테마 컬러 설정
- Service Worker: 오프라인 캐시 (정적 리소스)
- 푸시 알림: FCM + Service Worker 연동

---

## 8. 환경 변수

```env
# .env.local
NEXT_PUBLIC_API_URL=http://localhost:8000    # 백엔드 API 주소
NEXT_PUBLIC_SITE_URL=https://gonggu-moa.com  # 사이트 주소
NEXT_PUBLIC_GA_ID=G-XXXXXXXXXX               # Google Analytics
```

---

## 9. 코딩 규칙

| 항목 | 규칙 |
|------|------|
| 컴포넌트 | PascalCase 파일명 (`GongguCard.tsx`) |
| 함수/변수 | camelCase |
| CSS 클래스 | Tailwind 유틸리티 우선, 커스텀 클래스 최소화 |
| API 함수 | `lib/api/` 하위에 도메인별 분리 |
| 타입 정의 | `types/` 하위에 도메인별 분리, 백엔드 응답 타입과 일치시킬 것 |
| 이미지 | `next/image` 사용, 외부 이미지는 `next.config.js`에 도메인 등록 |
| 커밋 | Conventional Commits (`feat:`, `fix:`, `style:` 등) |
