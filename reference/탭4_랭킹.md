# 지도 화면 (Tab 4) - 멍이랑 (withbowwow)

> 주변 상점, 공원, 동물병원을 한눈에. NRC의 러닝 코스 탐색 기능을 반려동물 산책에 적용.
> "산책 나가기 전에 어디로 갈지 확인하는" 실용적 유틸리티 탭.

---

## 1. 페이지 개요

### 1.1 목적

지도 탭은 멍이랑 앱의 **실용적 유틸리티 허브**다. 반려동물과 산책할 때 필요한 주변 장소(공원, 카페, 동물병원, 약국, 상점)를 지도 위에 한눈에 보여주어 산책 계획을 돕는다. Nike Run Club이 러닝 코스를 탐색하게 하듯, 멍이랑은 반려동물 동반 가능 장소를 탐색하게 한다. 기존 랭킹 탭의 위치를 대체하며, 랭킹 기능은 소셜 탭의 주간 리더보드로 통합되었다.

### 1.2 핵심 사용자 니즈

| 니즈 | 설명 | 우선순위 |
|------|------|---------|
| 주변 공원 찾기 | 산책하기 좋은 공원/산책로 탐색 | 최상위 |
| 동물병원 위치 확인 | 응급 상황 또는 정기 검진용 병원 검색 | 상위 |
| 반려동물 동반 카페 | 함께 갈 수 있는 카페/식당 탐색 | 상위 |
| 반려동물 약국/상점 | 사료, 간식, 용품 구매 가능한 상점 | 중위 |
| 장소 정보 확인 | 거리, 평점, 영업시간 등 상세 정보 | 중위 |

### 1.3 진입 경로

| 경로 | 빈도 | 컨텍스트 |
|------|------|---------|
| 하단 탭 바 "지도" 탭 | 높음 | 산책 전 주변 장소 확인 |
| 홈 → 주변 장소 카드 → "전체보기" | 중간 | 홈에서 장소 정보 진입 |
| 산책 중 → 주변 검색 | 중간 | 산책 도중 근처 시설 탐색 |
| 푸시 알림 (신규 장소 등록) | 낮음 | "근처에 새 반려동물 카페가 열렸어요!" |

---

## 2. 화면 구성

### 섹션 1: 공통 헤더 (App Header)

#### 콘텐츠 구성

| 요소 | 위치 | 상세 |
|------|------|------|
| 앱 로고 + 텍스트 | 좌측 | "멍이랑" 로고 (발바닥 아이콘 + 텍스트) |
| 알림 벨 아이콘 | 우측 #1 | 읽지 않은 알림 시 빨간 뱃지 표시 |
| 설정 아이콘 | 우측 #2 | 톱니바퀴 아이콘 → 설정 스크린 |

#### 이 콘텐츠가 있는 이유

> 공통 헤더는 모든 탭에서 동일한 구조를 유지하여 사용자에게 일관된 경험을 제공한다. 기존에 있던 GPS 뱃지는 제거되었다. 지도 탭 자체가 위치 기반 기능이므로 GPS 상태를 별도로 표시할 필요가 없으며, 헤더를 간결하게 유지하는 것이 NRC 스타일의 미니멀 디자인에 부합한다.

---

### 섹션 2: 지도 영역 (Map Area)

#### 콘텐츠 구성

| 요소 | 상세 |
|------|------|
| 지도 크기 | Full-width, 50vh 높이 (화면 절반) |
| 사용자 위치 | 파란색 원형 점 + 펄스(pulse) 애니메이션 |
| 장소 핀 (공원) | 초록색 핀 |
| 장소 핀 (카페) | 주황색 핀 |
| 장소 핀 (동물병원) | 파란색 핀 |
| 장소 핀 (약국) | 보라색 핀 |
| 장소 핀 (상점) | 회색 핀 |
| 지도 컨트롤 | 우측 하단: 내 위치 버튼 + 확대/축소 버튼 |
| 핀 클러스터링 | 줌 레벨에 따라 가까운 핀 그룹화 (숫자 뱃지 표시) |
| 핀 탭 액션 | 핀 탭 시 미니 카드 팝업 → 탭하면 하단 시트에서 상세 |

#### 지도 핀 색상 코드

| 카테고리 | 색상 | 핀 아이콘 | HEX 코드 |
|---------|------|----------|----------|
| 공원 | 초록 | 나무 | #4CAF50 |
| 카페 | 주황 | 커피잔 | #FF9800 |
| 동물병원 | 파랑 | 병원 | #2196F3 |
| 약국 | 보라 | 약 | #9C27B0 |
| 상점 | 회색 | 카트 | #757575 |

#### 이 콘텐츠가 있는 이유

> 지도 영역은 이 탭의 **시각적 중심이자 기능적 핵심**이다.
>
> - **사용자 행동 심리학**: Spatial Cognition(공간 인지)에 의해 사람은 지도 위에 시각적으로 배치된 정보를 텍스트 리스트보다 훨씬 빠르고 직관적으로 처리한다. 펄스 애니메이션이 있는 파란 점(내 위치)은 Anchoring Effect를 활용하여 "나를 중심으로" 주변을 탐색하는 프레임을 자연스럽게 형성한다.
> - **비즈니스 목표**: 지도 탭은 지역 비즈니스(카페, 병원, 상점)와의 파트너십 수익 모델의 기반이다. 지도 위 "추천 장소" 핀을 프리미엄 광고 상품으로 운영할 수 있다.
> - **50vh 높이의 이유**: 지도가 화면의 절반을 차지하면 상단에서 충분히 넓은 지도를 보면서 하단 시트로 리스트도 함께 확인할 수 있다. Google Maps의 탐색 모드, 카카오맵의 "주변" 탭과 동일한 패턴이다.
> - **색상 코드 핀**: 카테고리별 색상 구분은 Pre-attentive Processing(전주의적 처리)을 활용한다. 5가지 색상은 Miller's Law(7+-2개)의 하한선 이내로 인지 부하가 적다.

---

### 섹션 3: 카테고리 필터 바 (Category Filter Bar)

#### 콘텐츠 구성

| 요소 | 상세 |
|------|------|
| 위치 | 지도 영역 하단, 하단 시트 상단에 고정 |
| 형태 | 가로 스크롤 가능한 필터 칩(Chip) 리스트 |
| 기본 상태 | "전체" 선택됨 (모든 핀 표시) |
| 필터 항목 | 전체 / 상점 / 공원 / 카페 / 병원 / 약국 |
| 활성 상태 | 선택된 칩: Primary 컬러 배경 + 흰 텍스트 + 개수 뱃지 |
| 비활성 상태 | 미선택 칩: 회색 테두리 + 회색 텍스트 |
| 다중 선택 | 여러 카테고리 동시 선택 가능 |
| 개수 뱃지 | 각 카테고리의 주변 장소 수 표시 (예: "공원 7") |

#### 필터 칩 레이아웃

```
← 가로 스크롤 →

[전체 27] [🛒 상점 4] [🌳 공원 7] [☕ 카페 5] [🏥 병원 4] [💊 약국 3]
  (활성)     (비활성)    (비활성)     (비활성)    (비활성)     (비활성)
```

#### 이 콘텐츠가 있는 이유

> 카테고리 필터 바는 사용자가 **원하는 정보만 빠르게 필터링**하는 도구다. Google Maps의 카테고리 칩(음식점, 카페, 주유소 등)은 지도 기반 앱의 표준 UX 패턴이다. 반려동물 특화 카테고리(상점, 공원, 동물병원, 약국)를 구성하여 범용 지도 앱과의 차별화를 이룬다.

---

### 섹션 4: 하단 시트 - 장소 리스트 (Bottom Sheet - Place List)

#### 콘텐츠 구성

| 요소 | 상세 |
|------|------|
| 형태 | 드래그 가능한 하단 시트 (Bottom Sheet) |
| 시트 상태 | Peek(미니) / Half(중간) / Full(전체) |
| Peek 높이 | 카테고리 필터 바 + 상위 2개 카드 미리보기 |
| Half 높이 | 화면 50% (지도와 반반) |
| Full 높이 | 화면 90% (지도 최소화) |
| 드래그 핸들 | 상단 중앙 회색 바 (4px x 36px) |
| 리스트 정렬 | 거리순 (기본) / 평점순 / 이름순 |

#### 장소 카드 레이아웃

```
┌──────────────────────────────────────┐
│ [🌳]  서울숲                          │
│       공원 · 650m                     │
│       ★ 4.7 (128) · 반려동물 동반 가능 │
│       영업시간: 상시 개방               │
└──────────────────────────────────────┘
┌──────────────────────────────────────┐
│ [☕]  멍멍카페 성수점                   │
│       카페 · 320m                     │
│       ★ 4.5 (87) · 소형견/중형견 가능  │
│       영업시간: 10:00~22:00            │
└──────────────────────────────────────┘
┌──────────────────────────────────────┐
│ [🏥]  행복동물병원                     │
│       동물병원 · 480m                  │
│       ★ 4.8 (256) · 24시 응급 가능    │
│       영업시간: 09:00~21:00            │
└──────────────────────────────────────┘
```

#### 장소 카드 구성 요소

| 요소 | 상세 |
|------|------|
| 카테고리 아이콘 | 좌측 원형 아이콘 (색상 코드에 맞춤) |
| 장소 이름 | Bold, 16pt |
| 카테고리 태그 | 상점 / 공원 / 카페 / 병원 / 약국 |
| 거리 | 현재 위치 기준 직선 거리 (m/km) |
| 평점 | 별점 + 리뷰 수 |
| 부가 정보 | 반려동물 허용 조건, 영업시간 등 |
| 탭 액션 | 장소 상세 화면으로 이동 |

#### 장소 상세 화면 (별도 스크린)

| 요소 | 상세 |
|------|------|
| 장소 사진 | 가로 스크롤 사진 갤러리 |
| 기본 정보 | 이름, 주소, 전화번호, 영업시간 |
| 반려동물 정보 | 동반 가능 크기, 제한 사항, 시설 (물그릇, 마당 등) |
| 지도 미니맵 | 장소 위치 표시 + 길찾기 버튼 |
| 리뷰 | 사용자 리뷰 (반려동물과 함께 방문한 후기) |
| 액션 버튼 | 전화 걸기 / 길찾기 / 공유하기 / 즐겨찾기 |

#### 이 콘텐츠가 있는 이유

> 하단 시트는 **지도와 리스트를 동시에 사용하는 인터페이스 패턴**이다. Dual Coding Theory(이중 부호화 이론)에 의해 시각(지도)과 언어(리스트)를 동시에 제공하면 정보 처리 효율이 극대화된다. 드래그 가능한 3단계 시트는 사용자가 자신에게 맞는 정보 비율을 조절할 수 있게 한다.

---

### 섹션 5: 하단 탭 네비게이션 (Bottom Tab Navigation)

#### 콘텐츠 구성

| 탭 | 아이콘 | 라벨 | 상태 |
|----|--------|------|------|
| 홈 | 집 | 홈 | 비활성 |
| 소셜 | 사람들 | 소셜 | 비활성 |
| 산책 | 발바닥 | 산책 | Floating (중앙 돌출) |
| 지도 | 핀 | 지도 | **활성 (Primary 컬러)** |
| MY | 사람 | MY | 비활성 |

#### 이 콘텐츠가 있는 이유

> 기존 "랭킹" 탭이 "지도" 탭으로 변경되었다. 랭킹 기능은 소셜 탭의 주간 리더보드로 통합되었으며, 지도 탭은 산책의 실용적 가치(어디로 갈까?)를 직접적으로 제공하는 유틸리티 탭으로서 더 높은 사용 빈도가 예상된다.
>
> - **탭 변경 이유**: NRC는 별도의 랭킹 탭 없이 소셜 기능 내에서 리더보드를 제공한다. 반면 산책 앱에서 "주변 장소 찾기"는 매일 사용하는 핵심 기능이므로 독립 탭으로 승격시켰다. 랭킹 전용 탭은 주 1~2회 확인에 그치지만, 지도 탭은 매 산책마다 활용 가능하다.
> - **비즈니스 목표**: 지도 탭은 O2O(Online to Offline) 비즈니스의 핵심 인프라다. 반려동물 관련 지역 비즈니스와의 파트너십, 광고, 쿠폰 등 수익 모델의 기반이 된다.

---

## 3. NRC 참고 사항

### 3.1 NRC와의 관계

Nike Run Club에는 전용 지도 탭이 없다. NRC는 러닝 코스를 홈에서 추천하거나 가이드 런 내에서 제안하는 방식을 취한다. 그러나 반려동물 산책은 러닝과 달리 **목적지 기반(destination-based)** 활동인 경우가 많다. "어느 공원으로 갈까", "근처에 동물병원이 어디 있지"와 같은 질문은 러너에게는 덜 중요하지만 산책자에게는 핵심적이다.

### 3.2 NRC에서 차용한 요소

| NRC 요소 | 멍이랑 적용 |
|----------|-----------|
| 러닝 코스 추천 | 산책 코스(공원 연결) 추천 |
| 근처 Nike 매장 | 근처 반려동물 상점/카페 |
| 미니멀 UI | 깔끔한 지도 + 하단 시트 구조 |
| 위치 기반 경험 | GPS 기반 장소 탐색 |

### 3.3 차별화 포인트

- NRC가 채우지 못하는 "유틸리티 갭"을 지도 탭이 해결한다
- 반려동물 동반 가능 여부라는 고유한 필터링 기준 제공
- 산책 전/중/후 모든 시점에서 활용 가능한 장소 정보 허브
- 지역 비즈니스 연동을 통한 O2O 수익 모델 기반

---

## 4. 와이어프레임 (ASCII)

```
┌──────────────────────────────┐
│  멍이랑              [🔔] [⚙️] │  ← 공통 헤더
├──────────────────────────────┤
│                              │
│  ┌──────────────────────────┐│
│  │                          ││
│  │    🌳        ☕          ││
│  │         🌳               ││
│  │              🏥          ││  ← 지도 영역 (50vh)
│  │    💊                    ││
│  │         ◉ (내 위치)      ││
│  │    ☕        🛒          ││
│  │              🌳          ││
│  │                     [📍] ││  ← 내 위치 버튼
│  │                     [+]  ││  ← 확대
│  │                     [-]  ││  ← 축소
│  └──────────────────────────┘│
│                              │
├──┬───────────────────────────┤  ← 드래그 핸들
│  │  ─── (드래그 바) ───       │
│  │                           │
│  │  [전체 27] [🛒 상점 4]     │
│  │  [🌳 공원 7] [☕ 카페 5]   │  ← 카테고리 필터 칩
│  │  [🏥 병원 4] [💊 약국 3]   │     (가로 스크롤)
│  │                           │
│  │  ┌────────────────────┐   │
│  │  │[🌳] 서울숲           │   │
│  │  │     공원 · 650m     │   │
│  │  │     ★ 4.7 (128)    │   │  ← 장소 카드
│  │  └────────────────────┘   │
│  │  ┌────────────────────┐   │
│  │  │[☕] 멍멍카페 성수점   │   │
│  │  │     카페 · 320m     │   │
│  │  │     ★ 4.5 (87)     │   │  ← 장소 카드
│  │  └────────────────────┘   │
│  │  ┌────────────────────┐   │
│  │  │[🏥] 행복동물병원     │   │
│  │  │     병원 · 480m     │   │
│  │  │     ★ 4.8 (256)    │   │  ← 장소 카드
│  │  └────────────────────┘   │
│  │                           │
│  │  (스크롤 계속...)          │
│  │                           │
├──┴───────────────────────────┤
│  [🏠] [👥] [🐾] [📍] [👤]   │  ← 하단 탭 바
│   홈   소셜  산책  지도  MY   │
└──────────────────────────────┘
```

### 지도 핀 탭 시 미니 카드

```
┌──────────────────────────────┐
│          (지도 영역)           │
│                              │
│     🌳 ← 탭                  │
│     ┌───────────────┐        │
│     │ 서울숲          │        │
│     │ 공원 · 650m    │ ← 미니 카드 팝업
│     │ ★ 4.7  [상세>] │        │
│     └───────────────┘        │
│                              │
└──────────────────────────────┘
```

---

## 5. UX 설계 의도

### 5.1 정보 계층 구조

```
[1순위 - 공간 탐색]
  └── 지도 영역 (시각적 공간 파악)
  └── 사용자 위치 기준 장소 분포 인지

[2순위 - 필터링]
  └── 카테고리 필터 바 (원하는 장소 유형 선택)

[3순위 - 상세 정보]
  └── 하단 시트 장소 리스트 (거리, 평점, 상세)
  └── 장소 상세 화면 (사진, 리뷰, 길찾기)
```

핵심 원칙: **"공간 → 필터 → 상세" 순서의 정보 탐색 퍼널**이다. 지도에서 전체적인 분포를 파악하고, 필터로 원하는 카테고리를 좁히며, 리스트에서 상세 정보를 확인한다.

### 5.2 인터랙션 패턴

| 패턴 | 적용 위치 | 설명 |
|------|----------|------|
| Drag Bottom Sheet | 하단 시트 | 3단계 높이 조절 (Peek/Half/Full) |
| Pin Clustering | 지도 핀 | 줌 레벨에 따라 인접 핀 그룹화 |
| Tap to Preview | 지도 핀 | 핀 탭 시 미니 카드 팝업 |
| Category Filter | 필터 칩 | 다중 선택 가능한 카테고리 필터 |
| Pull-to-Refresh | 장소 리스트 | 최신 장소 데이터 새로고침 |
| Location Tracking | 내 위치 버튼 | 현재 위치로 지도 중심 이동 |
| Pinch to Zoom | 지도 | 핀치로 확대/축소 |
| Map Pan | 지도 | 드래그로 지도 이동 |
| Haptic Feedback | 핀 탭 | 핀 선택 시 가벼운 진동 |

### 5.3 접근성 고려사항

| 항목 | 대응 |
|------|------|
| 색상 대비 | 핀 색상이 지도 배경과 4.5:1 이상 대비 |
| 핀 구분 | 색상 외에 아이콘 형태로도 카테고리 구분 |
| 스크린 리더 | "서울숲, 공원, 650미터, 별점 4.7" 구조화 읽기 |
| 터치 영역 | 지도 핀 터치 영역 최소 44x44px |
| 키보드 접근 | 필터 칩, 장소 카드에 포커스 순서 지정 |
| 고대비 모드 | 핀 색상 진하게 + 테두리 추가 |

---

## 6. 데이터 요구사항

| 데이터 | API/소스 | 갱신 주기 |
|--------|---------|----------|
| 사용자 위치 | GPS (Geolocation API) | 실시간 (5초 간격) |
| 장소 데이터 | Supabase (places 테이블) | 일 1회 배치 + 실시간 추가 |
| 장소 카테고리 | Supabase (place_categories) | 정적 데이터 |
| 평점/리뷰 | Supabase (reviews 테이블) | 사용자 작성 시 실시간 |
| 영업시간 | Supabase (places.hours) | 운영자 수정 시 |
| 즐겨찾기 | Supabase (user_favorites) | 사용자 토글 시 |
| 외부 장소 | 카카오 Maps API / Google Places API | 초기 데이터 수집 |

### 장소 검색 SQL 예시

```sql
-- 현재 위치 기준 반경 2km 내 장소 검색
SELECT
  p.id,
  p.name,
  p.category,
  p.address,
  p.latitude,
  p.longitude,
  p.rating,
  p.review_count,
  p.pet_friendly_info,
  p.business_hours,
  ST_Distance(
    ST_MakePoint(p.longitude, p.latitude)::geography,
    ST_MakePoint(:user_lng, :user_lat)::geography
  ) AS distance_m
FROM places p
WHERE ST_DWithin(
  ST_MakePoint(p.longitude, p.latitude)::geography,
  ST_MakePoint(:user_lng, :user_lat)::geography,
  2000  -- 반경 2km
)
AND p.category = ANY(:selected_categories)
ORDER BY distance_m ASC;
```

---

*작성일: 2026-02-19*
*버전: 3.0 (랭킹 탭 → 지도 탭 전환, NRC 스타일 리디자인)*
