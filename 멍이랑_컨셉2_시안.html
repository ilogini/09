<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Î©çÏù¥Îûë withbowwow - Î∞òÎ†§ÎèôÎ¨º ÏÇ∞Ï±Ö Ïï± (Ïª®ÏÖâ2: Urban Sporty)</title>
    <!-- Pretendard Variable -->
    <link href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/variable/pretendardvariable.min.css" rel="stylesheet">
    <!-- Material Symbols Sharp -->
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Sharp:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" rel="stylesheet">
    <!-- Leaflet.js -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <style>
        /* ===== Material Symbols Config ===== */
        .material-symbols-sharp {
            font-variation-settings: 'FILL' 1, 'wght' 500, 'GRAD' 0, 'opsz' 24;
            font-size: 24px;
            line-height: 1;
            vertical-align: middle;
        }

        :root {
            --mint: #40C1AC;
            --mint-dark: #2EA898;
            --mint-light: #E0F7F3;
            --mint-glow: rgba(64,193,172,0.25);
            --orange: #FF4500;
            --orange-dark: #E03D00;
            --orange-light: #FFF0EB;
            --orange-glow: rgba(255,69,0,0.25);
            --powder: #B0D4F1;
            --powder-light: #E8F2FB;
            --navy: #0D2137;
            --navy-mid: #162D47;
            --navy-light: #1E3A5A;
            --dark: #0F1923;
            --text: #111827;
            --text-secondary: #64748B;
            --text-light: #94A3B8;
            --bg: #F0F4F7;
            --white: #FFFFFF;
            --card-dark: #1A2D42;
            --card-darker: #142435;
            --border: #E2E8F0;
            --danger: #EF4444;
            --shadow-sm: 0 1px 3px rgba(13,33,55,0.08);
            --shadow: 0 4px 12px rgba(13,33,55,0.10);
            --shadow-lg: 0 8px 24px rgba(13,33,55,0.14);
            --shadow-xl: 0 16px 40px rgba(13,33,55,0.18);
            --radius: 12px;
            --radius-sm: 8px;
            --radius-xs: 6px;
            --nav-height: 72px;
            --header-height: 60px;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        body {
            font-family: 'Pretendard Variable', 'Pretendard', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg);
            color: var(--text);
            max-width: 480px;
            margin: 0 auto;
            min-height: 100vh;
            position: relative;
            overflow-x: hidden;
        }

        /* ===== Header (Dark Navy) ===== */
        .header {
            position: sticky; top: 0; z-index: 100;
            background: var(--navy);
            padding: 0 20px;
            display: flex; align-items: center; justify-content: space-between;
            height: var(--header-height);
        }
        .header-logo { display: flex; align-items: center; gap: 10px; }
        .header-logo .logo-mark {
            width: 36px; height: 36px;
            background: linear-gradient(135deg, var(--mint), var(--orange));
            clip-path: polygon(50% 0%, 100% 25%, 100% 75%, 50% 100%, 0% 75%, 0% 25%);
            display: flex; align-items: center; justify-content: center;
        }
        .header-logo .logo-mark .material-symbols-sharp {
            color: var(--white); font-size: 20px;
        }
        .header-logo .logo-text { display: flex; flex-direction: column; line-height: 1.1; }
        .header-logo .logo-text .brand {
            font-size: 18px; font-weight: 800; color: var(--white);
            letter-spacing: -0.5px;
        }
        .header-logo .logo-text .brand em { font-style: normal; color: var(--mint); }
        .header-logo .logo-text .slogan {
            font-size: 9px; font-weight: 600; color: var(--mint);
            letter-spacing: 2px; text-transform: uppercase; margin-top: 2px;
        }
        .header-actions { display: flex; align-items: center; gap: 8px; }
        .header-btn {
            width: 36px; height: 36px; border-radius: var(--radius-xs);
            border: none; background: var(--navy-mid);
            cursor: pointer; display: flex; align-items: center; justify-content: center;
            position: relative; transition: background 0.2s;
        }
        .header-btn .material-symbols-sharp { color: var(--white); font-size: 20px; }
        .header-btn:hover { background: var(--navy-light); }
        .notification-dot {
            position: absolute; top: 5px; right: 5px;
            width: 8px; height: 8px; background: var(--orange);
            border-radius: 50%; border: 2px solid var(--navy);
        }

        /* ===== GPS Badge ===== */
        .gps-badge {
            display: flex; align-items: center; gap: 5px;
            padding: 5px 10px; border-radius: 6px;
            font-size: 11px; font-weight: 700;
            background: var(--navy-mid); color: var(--text-light);
            transition: all 0.3s; letter-spacing: 0.5px;
        }
        .gps-badge.on { background: rgba(64,193,172,0.15); color: var(--mint); }
        .gps-dot { width: 7px; height: 7px; border-radius: 50%; background: var(--text-light); }
        .gps-badge.on .gps-dot { background: var(--orange); animation: gpsPulse 1.5s infinite; }
        @keyframes gpsPulse {
            0%,100% { opacity:1; box-shadow:0 0 0 0 var(--orange-glow); }
            50% { opacity:0.8; box-shadow:0 0 0 5px rgba(255,69,0,0); }
        }

        /* ===== Content ===== */
        .content { padding-bottom: calc(var(--nav-height) + 20px); }

        /* ===== Weather (Dark Card + Mint Border) ===== */
        .weather-bar {
            background: var(--navy);
            margin: 16px 16px 0; padding: 16px 18px;
            border-radius: var(--radius);
            display: flex; align-items: center; justify-content: space-between;
            border-left: 4px solid;
            border-image: linear-gradient(to bottom, var(--mint), var(--powder)) 1;
            position: relative; overflow: hidden;
        }
        .weather-bar::after {
            content: ''; position: absolute; top: 0; right: 0;
            width: 120px; height: 100%;
            background: linear-gradient(135deg, transparent, rgba(64,193,172,0.05));
        }
        .weather-info { display: flex; align-items: center; gap: 12px; z-index: 1; }
        .weather-icon-box {
            width: 44px; height: 44px; border-radius: var(--radius-sm);
            background: var(--navy-mid);
            display: flex; align-items: center; justify-content: center;
        }
        .weather-icon-box .material-symbols-sharp { color: var(--mint); font-size: 26px; }
        .weather-text h4 { font-size: 14px; font-weight: 700; color: var(--white); }
        .weather-text p { font-size: 12px; color: var(--text-light); margin-top: 2px; }
        .weather-temp {
            font-size: 32px; font-weight: 900; color: var(--mint);
            letter-spacing: -1px; z-index: 1;
        }

        /* ===== Weekly Card (Dark Dashboard) ===== */
        .weekly-card {
            margin: 16px; background: var(--navy);
            border-radius: var(--radius); padding: 24px;
            box-shadow: var(--shadow-lg);
        }
        .weekly-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        .weekly-header h3 {
            font-size: 16px; font-weight: 800; color: var(--white);
            display: flex; align-items: center; gap: 8px;
        }
        .weekly-header h3 .material-symbols-sharp { color: var(--mint); font-size: 20px; }
        .weekly-header .period {
            font-size: 11px; font-weight: 600; color: var(--mint);
            background: rgba(64,193,172,0.12);
            padding: 4px 10px; border-radius: 6px; letter-spacing: 0.5px;
        }
        .weekly-stats { display: grid; grid-template-columns: repeat(3,1fr); gap: 12px; margin-bottom: 20px; }
        .stat-item {
            text-align: center; background: var(--navy-mid);
            border-radius: var(--radius-sm); padding: 14px 6px;
        }
        .stat-value { font-size: 28px; font-weight: 900; color: var(--mint); line-height: 1.2; letter-spacing: -1px; }
        .stat-value .unit { font-size: 12px; font-weight: 600; color: var(--text-light); letter-spacing: 0; }
        .stat-label { font-size: 11px; color: var(--text-light); margin-top: 4px; font-weight: 500; }
        .progress-section { margin-top: 4px; }
        .progress-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px; }
        .progress-header span { font-size: 12px; color: var(--text-light); font-weight: 500; }
        .progress-header strong { font-size: 18px; font-weight: 900; color: var(--orange); }
        .progress-bar {
            height: 12px; background: var(--navy-mid);
            border-radius: 4px; overflow: hidden; position: relative;
        }
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--mint), var(--orange));
            border-radius: 4px;
            transition: width 1s ease;
            position: relative;
            overflow: hidden;
        }
        .progress-fill::after {
            content: '';
            position: absolute; inset: 0;
            background: repeating-linear-gradient(
                -45deg,
                transparent, transparent 6px,
                rgba(255,255,255,0.12) 6px,
                rgba(255,255,255,0.12) 12px
            );
            animation: stripeMove 0.8s linear infinite;
        }
        @keyframes stripeMove { 0%{transform:translateX(0)} 100%{transform:translateX(17px)} }

        /* ===== Walk Start (Split Two-Tone) ===== */
        .walk-start-section { margin: 16px 16px 0; }
        .walk-start-btn-main {
            width: 100%; padding: 18px 24px;
            background: var(--mint);
            color: white; border: none; border-radius: 8px;
            font-size: 17px; font-weight: 800; font-family: inherit;
            cursor: pointer; display: flex; align-items: center; gap: 16px;
            box-shadow: 0 6px 20px var(--mint-glow);
            transition: all 0.3s; position: relative; overflow: hidden;
            text-transform: uppercase; letter-spacing: 1px;
        }
        .walk-start-btn-main::after {
            content: '';
            position: absolute; right: 0; top: 0;
            width: 40%; height: 100%;
            background: var(--orange);
            clip-path: polygon(20% 0, 100% 0, 100% 100%, 0% 100%);
            transition: width 0.3s;
        }
        .walk-start-btn-main:hover::after { width: 50%; }
        .walk-start-btn-main:hover { transform: translateY(-2px); box-shadow: 0 10px 28px var(--mint-glow); }
        .walk-start-btn-main:active { transform: translateY(0); }
        .walk-start-btn-main .btn-icon {
            width: 44px; height: 44px;
            background: rgba(255,255,255,0.2);
            border-radius: 8px;
            display: flex; align-items: center; justify-content: center;
            z-index: 1;
        }
        .walk-start-btn-main .btn-icon .material-symbols-sharp { font-size: 26px; color: var(--white); }
        .walk-start-btn-main .btn-content { flex: 1; text-align: left; z-index: 1; }
        .walk-start-btn-main .btn-content .main-text { font-size: 17px; }
        .walk-start-btn-main .btn-content .sub-text { font-size: 11px; font-weight: 500; opacity: 0.85; margin-top: 2px; text-transform: none; letter-spacing: 0; }
        .walk-start-btn-main .btn-arrow {
            z-index: 1;
            animation: arrowSlide 1.5s ease-in-out infinite;
        }
        .walk-start-btn-main .btn-arrow .material-symbols-sharp { font-size: 28px; }
        @keyframes arrowSlide {
            0%,100%{transform:translateX(0)} 50%{transform:translateX(6px)}
        }

        /* ===== Section Title ===== */
        .section-title { padding: 24px 16px 12px; display: flex; justify-content: space-between; align-items: center; }
        .section-title h3 {
            font-size: 17px; font-weight: 800;
            display: flex; align-items: center; gap: 8px;
            letter-spacing: -0.3px;
        }
        .section-title h3 .material-symbols-sharp { color: var(--mint); font-size: 22px; }
        .section-title .more {
            font-size: 12px; font-weight: 600; color: var(--text-light);
            text-decoration: none; cursor: pointer;
            display: flex; align-items: center; gap: 2px;
        }
        .section-title .more .material-symbols-sharp { font-size: 16px; }
        .section-title .more:hover { color: var(--mint); }

        /* ===== Pets (Dark Card + Left Stripe) ===== */
        .pets-scroll { padding: 0 16px; display: flex; gap: 12px; overflow-x: auto; scrollbar-width: none; }
        .pets-scroll::-webkit-scrollbar { display: none; }
        .pet-card {
            min-width: 150px; background: var(--navy);
            border-radius: var(--radius); padding: 16px;
            border-left: 4px solid var(--navy-light);
            cursor: pointer; transition: all 0.2s; flex-shrink: 0;
            display: flex; flex-direction: column; align-items: flex-start;
        }
        .pet-card:hover { border-left-color: var(--mint); }
        .pet-card.selected {
            border-left-color: var(--orange);
            box-shadow: 0 0 0 1px var(--orange), 0 4px 16px var(--orange-glow);
        }
        .pet-avatar {
            width: 52px; height: 52px; border-radius: 10px;
            margin-bottom: 10px; display: flex; align-items: center; justify-content: center;
            font-size: 28px;
        }
        .pet-avatar.dog { background: var(--navy-mid); }
        .pet-avatar.cat { background: var(--navy-mid); }
        .pet-avatar.add { background: var(--navy-mid); border: 2px dashed var(--navy-light); }
        .pet-avatar.add .material-symbols-sharp { color: var(--text-light); font-size: 24px; }
        .pet-card h4 { font-size: 15px; font-weight: 700; color: var(--white); }
        .pet-card p { font-size: 11px; color: var(--text-light); margin-top: 2px; }
        .pet-card .pet-stat {
            margin-top: 8px; font-size: 12px; font-weight: 700;
            color: var(--mint); letter-spacing: -0.3px;
        }

        /* ===== Ranking (Sharp Angular) ===== */
        .ranking-card {
            margin: 0 16px; background: var(--white);
            border-radius: var(--radius); overflow: hidden;
            box-shadow: var(--shadow);
        }
        .ranking-tabs {
            display: flex; padding: 6px; gap: 4px;
            background: var(--bg);
        }
        .ranking-tab {
            flex: 1; padding: 10px; text-align: center;
            font-size: 13px; font-weight: 700; color: var(--text-light);
            border: none; background: none; cursor: pointer;
            font-family: inherit; border-radius: 6px;
            transition: all 0.2s; letter-spacing: 0.3px;
        }
        .ranking-tab.active {
            color: var(--white); background: var(--mint);
            box-shadow: 0 2px 8px var(--mint-glow);
        }
        .ranking-list { padding: 4px 0; }
        .ranking-item {
            display: flex; align-items: center; padding: 12px 16px;
            gap: 12px; transition: background 0.2s;
        }
        .ranking-item:hover { background: var(--bg); }
        .ranking-item.me {
            background: var(--navy);
            border-left: 4px solid var(--orange);
        }
        .ranking-item.me .rank-name,
        .ranking-item.me .rank-distance { color: var(--white); }
        .ranking-item.me .rank-pet { color: var(--text-light); }
        .rank-num {
            width: 30px; height: 30px; border-radius: 6px;
            display: flex; align-items: center; justify-content: center;
            font-size: 14px; font-weight: 900; color: var(--text-secondary);
            background: var(--bg); flex-shrink: 0;
            letter-spacing: -0.5px;
        }
        .rank-1 { background: var(--orange); color: var(--white); }
        .rank-1-flame .material-symbols-sharp { color: var(--orange); font-size: 16px; margin-left: 2px; }
        .rank-2 { background: var(--mint); color: var(--white); }
        .rank-3 { background: var(--powder); color: var(--navy); }
        .rank-avatar {
            width: 40px; height: 40px; border-radius: 8px;
            background: var(--bg);
            display: flex; align-items: center; justify-content: center;
            font-size: 22px; flex-shrink: 0;
        }
        .ranking-item.me .rank-avatar { background: var(--navy-mid); }
        .rank-info { flex: 1; min-width: 0; }
        .rank-name {
            font-size: 14px; font-weight: 700;
            white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
            display: flex; align-items: center; gap: 4px;
        }
        .rank-pet { font-size: 11px; color: var(--text-light); margin-top: 1px; }
        .rank-distance { font-size: 16px; font-weight: 900; color: var(--navy); white-space: nowrap; letter-spacing: -0.5px; }
        .rank-distance .unit { font-size: 11px; font-weight: 600; color: var(--text-secondary); }

        /* ===== Challenge (Dark Cards, Neon Glow) ===== */
        .challenge-scroll {
            padding: 0 16px; display: flex; gap: 12px;
            overflow-x: auto; scroll-snap-type: x mandatory;
            -webkit-overflow-scrolling: touch; scrollbar-width: none;
        }
        .challenge-scroll::-webkit-scrollbar { display: none; }
        .challenge-item {
            min-width: 200px; background: var(--navy);
            border-radius: var(--radius); padding: 18px;
            scroll-snap-align: start; flex-shrink: 0;
            cursor: pointer; transition: transform 0.2s;
            position: relative; overflow: hidden;
        }
        .challenge-item:hover { transform: translateY(-2px); }
        .challenge-item::before {
            content: ''; position: absolute; top: 0; left: 0; right: 0;
            height: 2px;
        }
        .challenge-item.ch-dist::before { background: linear-gradient(90deg, var(--mint), var(--powder)); }
        .challenge-item.ch-streak::before { background: linear-gradient(90deg, var(--orange), #FFD700); }
        .challenge-item.ch-explore::before { background: linear-gradient(90deg, var(--powder), var(--mint)); }
        .challenge-item.ch-energy::before { background: linear-gradient(90deg, var(--orange), var(--mint)); }
        .challenge-badge {
            width: 44px; height: 44px; border-radius: 8px;
            display: flex; align-items: center; justify-content: center;
            margin-bottom: 12px;
        }
        .challenge-badge .material-symbols-sharp { font-size: 24px; }
        .challenge-badge.distance { background: rgba(64,193,172,0.15); }
        .challenge-badge.distance .material-symbols-sharp { color: var(--mint); }
        .challenge-badge.streak { background: rgba(255,69,0,0.15); }
        .challenge-badge.streak .material-symbols-sharp { color: var(--orange); }
        .challenge-badge.explore { background: rgba(176,212,241,0.2); }
        .challenge-badge.explore .material-symbols-sharp { color: var(--powder); }
        .challenge-badge.energy { background: rgba(255,69,0,0.1); }
        .challenge-badge.energy .material-symbols-sharp { color: var(--orange); }
        .challenge-item h4 { font-size: 14px; font-weight: 800; color: var(--white); margin-bottom: 4px; }
        .challenge-item p { font-size: 12px; color: var(--text-light); margin-bottom: 14px; }
        .challenge-progress { display: flex; align-items: center; gap: 8px; }
        .challenge-progress .bar { flex: 1; height: 4px; background: var(--navy-mid); border-radius: 2px; overflow: hidden; }
        .challenge-progress .bar-fill { height: 100%; border-radius: 2px; }
        .bar-fill.mint { background: var(--mint); box-shadow: 0 0 8px var(--mint-glow); }
        .bar-fill.orange { background: var(--orange); box-shadow: 0 0 8px var(--orange-glow); }
        .bar-fill.powder { background: var(--powder); }
        .bar-fill.gradient { background: linear-gradient(90deg, var(--orange), var(--mint)); }
        .challenge-progress span { font-size: 11px; font-weight: 700; color: var(--text-light); white-space: nowrap; }

        /* ===== Nearby ===== */
        .nearby-map-box {
            margin: 0 16px; height: 180px; border-radius: var(--radius);
            overflow: hidden; border: 2px solid var(--navy);
        }
        .nearby-map-box .leaflet-control-attribution { font-size: 8px !important; opacity: 0.5; }
        .nearby-list { padding: 12px 16px 0; display: flex; flex-direction: column; gap: 10px; }
        .nearby-item {
            display: flex; align-items: center; gap: 14px;
            padding: 14px; background: var(--white);
            border-radius: var(--radius); box-shadow: var(--shadow-sm);
            cursor: pointer; transition: all 0.2s;
            border-left: 4px solid transparent;
        }
        .nearby-item:hover { box-shadow: var(--shadow); transform: translateX(4px); }
        .nearby-item.type-park { border-left-color: var(--mint); }
        .nearby-item.type-cafe { border-left-color: #F59E0B; }
        .nearby-item.type-hospital { border-left-color: var(--powder); }
        .nearby-icon {
            width: 42px; height: 42px; border-radius: 8px;
            display: flex; align-items: center; justify-content: center;
            flex-shrink: 0;
        }
        .nearby-icon.park { background: var(--mint-light); }
        .nearby-icon.park .material-symbols-sharp { color: var(--mint-dark); }
        .nearby-icon.cafe { background: #FEF3C7; }
        .nearby-icon.cafe .material-symbols-sharp { color: #D97706; }
        .nearby-icon.hospital { background: var(--powder-light); }
        .nearby-icon.hospital .material-symbols-sharp { color: #3B82F6; }
        .nearby-info { flex: 1; min-width: 0; }
        .nearby-name { font-size: 14px; font-weight: 700; }
        .nearby-detail { font-size: 12px; color: var(--text-light); margin-top: 2px; }
        .nearby-dist { font-size: 14px; font-weight: 800; color: var(--orange); white-space: nowrap; }

        /* ===== Ad Banner ===== */
        .ad-banner {
            margin: 20px 16px 0; padding: 14px 18px;
            background: var(--white); border-radius: var(--radius);
            display: flex; align-items: center; gap: 14px;
            cursor: pointer; position: relative;
            box-shadow: var(--shadow-sm);
        }
        .ad-badge {
            font-size: 9px; font-weight: 800; color: var(--text-light);
            background: var(--bg); padding: 2px 6px; border-radius: 4px;
            position: absolute; top: 8px; right: 8px;
            letter-spacing: 1px;
        }
        .ad-banner .ad-icon-box {
            width: 44px; height: 44px; border-radius: 8px;
            background: var(--mint-light);
            display: flex; align-items: center; justify-content: center;
        }
        .ad-banner .ad-icon-box .material-symbols-sharp { color: var(--mint-dark); font-size: 22px; }
        .ad-banner .ad-text h4 { font-size: 13px; font-weight: 700; }
        .ad-banner .ad-text p { font-size: 11px; color: var(--text-secondary); margin-top: 2px; }

        /* ===== Recent Walks ===== */
        .recent-walks { padding: 0 16px; display: flex; flex-direction: column; gap: 10px; }
        .walk-item {
            display: flex; align-items: center; gap: 14px;
            padding: 16px; background: var(--white);
            border-radius: var(--radius); box-shadow: var(--shadow-sm);
            cursor: pointer; transition: all 0.2s;
        }
        .walk-item:hover { box-shadow: var(--shadow); }
        .walk-route-mini {
            width: 52px; height: 52px; border-radius: 8px;
            background: var(--navy);
            display: flex; align-items: center; justify-content: center;
            flex-shrink: 0;
        }
        .walk-route-mini svg { width: 32px; height: 32px; }
        .walk-info { flex: 1; min-width: 0; }
        .walk-date { font-size: 12px; color: var(--text-light); font-weight: 500; }
        .walk-title { font-size: 14px; font-weight: 700; margin-top: 2px; }
        .walk-meta { display: flex; gap: 12px; margin-top: 4px; }
        .walk-meta span {
            font-size: 12px; color: var(--text-secondary);
            display: flex; align-items: center; gap: 3px;
        }
        .walk-meta span .material-symbols-sharp { font-size: 14px; color: var(--mint); }
        .walk-meta span strong { color: var(--text); font-weight: 700; }

        /* ===== Premium Banner (Dark + Gradient Top) ===== */
        .premium-banner {
            margin: 20px 16px 0; padding: 18px 20px;
            background: var(--dark);
            border-radius: var(--radius);
            display: flex; align-items: center; gap: 14px;
            cursor: pointer; transition: transform 0.2s;
            position: relative; overflow: hidden;
        }
        .premium-banner::before {
            content: ''; position: absolute; top: 0; left: 0; right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--mint), var(--orange));
        }
        .premium-banner:hover { transform: translateY(-2px); }
        .premium-icon-box {
            width: 44px; height: 44px;
            background: linear-gradient(135deg, var(--mint), var(--orange));
            border-radius: 8px;
            display: flex; align-items: center; justify-content: center;
        }
        .premium-icon-box .material-symbols-sharp { color: var(--white); font-size: 24px; }
        .premium-text h4 { font-size: 14px; font-weight: 800; color: var(--white); }
        .premium-text p { font-size: 12px; color: var(--text-light); margin-top: 2px; }
        .premium-price { margin-left: auto; text-align: right; }
        .premium-price .price { font-size: 18px; font-weight: 900; color: var(--orange); }
        .premium-price .period { font-size: 11px; color: var(--text-light); }

        /* ===== Bottom Nav (Dark, Square Center) ===== */
        .bottom-nav {
            position: fixed; bottom: 0; left: 50%; transform: translateX(-50%);
            width: 100%; max-width: 480px; height: var(--nav-height);
            background: var(--navy);
            border-top: 1px solid var(--navy-light);
            display: flex; align-items: center; justify-content: space-around;
            padding: 0 4px;
            padding-bottom: env(safe-area-inset-bottom, 0);
            z-index: 200;
        }
        .nav-item {
            display: flex; flex-direction: column; align-items: center;
            gap: 3px; padding: 8px 12px; border: none; background: none;
            cursor: pointer; font-family: inherit; transition: all 0.2s;
            position: relative; min-width: 52px;
        }
        .nav-item .nav-icon { transition: transform 0.2s; }
        .nav-item .nav-icon .material-symbols-sharp {
            font-size: 24px; color: var(--text-light);
            font-variation-settings: 'FILL' 0, 'wght' 400;
        }
        .nav-item .nav-label { font-size: 10px; font-weight: 500; color: var(--text-light); transition: color 0.2s; }
        .nav-item.active .nav-icon .material-symbols-sharp {
            color: var(--orange);
            font-variation-settings: 'FILL' 1, 'wght' 600;
        }
        .nav-item.active .nav-label { color: var(--orange); font-weight: 700; }
        .nav-item.active::after {
            content: ''; position: absolute; bottom: 4px;
            width: 16px; height: 2px; background: var(--orange);
            border-radius: 2px;
        }
        .nav-item:hover .nav-icon { transform: translateY(-2px); }
        .nav-item.center-btn { position: relative; top: -16px; }
        .nav-item.center-btn .nav-icon {
            width: 56px; height: 56px;
            background: linear-gradient(135deg, var(--orange), var(--mint));
            border-radius: 12px;
            display: flex; align-items: center; justify-content: center;
            box-shadow: 0 4px 16px var(--orange-glow);
        }
        .nav-item.center-btn .nav-icon .material-symbols-sharp {
            color: var(--white) !important; font-size: 28px;
            font-variation-settings: 'FILL' 1, 'wght' 700;
        }
        .nav-item.center-btn:hover .nav-icon {
            transform: translateY(-4px);
            box-shadow: 0 8px 24px var(--orange-glow);
        }
        .nav-item.center-btn .nav-label { color: var(--mint); font-weight: 700; }
        .nav-item.center-btn.active::after { display: none; }

        /* ===== Walk Screen ===== */
        .walk-screen {
            display: none; position: fixed; inset: 0; z-index: 300;
            background: var(--bg);
            max-width: 480px; margin: 0 auto;
            flex-direction: column;
        }
        .walk-screen.active { display: flex; }
        .walk-screen-header {
            display: flex; align-items: center; justify-content: space-between;
            padding: 10px 16px;
            background: var(--navy);
            flex-shrink: 0; z-index: 10;
        }
        .walk-screen-header h3 {
            font-size: 15px; font-weight: 800; color: var(--white);
            display: flex; align-items: center; gap: 6px;
        }
        .walk-screen-header h3 .material-symbols-sharp { color: var(--mint); font-size: 20px; }
        .walk-close-btn {
            width: 36px; height: 36px; border-radius: 8px;
            border: none; background: var(--navy-mid);
            cursor: pointer; display: flex; align-items: center; justify-content: center;
        }
        .walk-close-btn .material-symbols-sharp { color: var(--white); font-size: 20px; }

        /* Walk Map */
        .walk-map-area { flex: 1; position: relative; min-height: 0; }
        #walkMap { width: 100%; height: 100%; z-index: 1; }
        .leaflet-control-zoom { display: none !important; }
        .walk-map-controls {
            position: absolute; top: 12px; right: 12px; z-index: 10;
            display: flex; flex-direction: column; gap: 6px;
        }
        .wmap-btn {
            width: 40px; height: 40px;
            background: rgba(13,33,55,0.85); backdrop-filter: blur(8px);
            border: none; border-radius: 8px; box-shadow: var(--shadow);
            cursor: pointer; display: flex; align-items: center; justify-content: center;
            transition: all 0.2s;
        }
        .wmap-btn .material-symbols-sharp { color: var(--white); font-size: 20px; }
        .wmap-btn:active { transform: scale(0.92); }
        .wmap-btn.on { background: var(--mint); }
        .wmap-btn.on .material-symbols-sharp { color: var(--white); }

        .walk-dist-chip {
            position: absolute; bottom: 12px; left: 12px; z-index: 10;
            display: flex; align-items: center; gap: 10px;
            background: rgba(13,33,55,0.9); backdrop-filter: blur(8px);
            border-radius: 8px; padding: 10px 16px; box-shadow: var(--shadow-lg);
        }
        .walk-dist-chip .live-dot {
            width: 8px; height: 8px; border-radius: 50%;
            background: var(--orange); animation: gpsPulse 1s infinite;
        }
        .walk-dist-chip .dist-num {
            font-size: 22px; font-weight: 900; color: var(--mint);
            font-variant-numeric: tabular-nums; letter-spacing: -0.5px;
        }
        .walk-dist-chip .dist-unit { font-size: 11px; color: var(--text-light); font-weight: 600; }

        /* Walk Stats Panel (Dark) */
        .walk-stats-panel {
            background: var(--navy);
            border-radius: 16px 16px 0 0;
            padding: 16px 20px 28px;
            box-shadow: 0 -4px 20px rgba(13,33,55,0.3);
            flex-shrink: 0; z-index: 10;
        }
        .walk-pet-label {
            text-align: center; font-size: 13px; font-weight: 700;
            color: var(--mint); margin-bottom: 4px;
            display: flex; align-items: center; justify-content: center; gap: 6px;
        }
        .walk-pet-label .material-symbols-sharp { font-size: 18px; }
        .walk-pause-label {
            text-align: center; font-size: 13px; font-weight: 700;
            color: var(--orange); margin-bottom: 4px;
            align-items: center; justify-content: center; gap: 4px;
        }
        .walk-pause-label .material-symbols-sharp { font-size: 18px; }
        .walk-pause-label { display: none; }
        .walk-pause-label.on { display: flex; }
        .walk-timer {
            text-align: center; font-size: 52px; font-weight: 900;
            color: var(--white); letter-spacing: 2px;
            margin-bottom: 12px; font-variant-numeric: tabular-nums;
        }
        .walk-stats-grid { display: grid; grid-template-columns: repeat(2,1fr); gap: 10px; margin-bottom: 16px; }
        .walk-stat {
            text-align: center; background: var(--navy-mid);
            border-radius: var(--radius-sm); padding: 12px 6px;
        }
        .walk-stat .value {
            font-size: 22px; font-weight: 900; color: var(--mint);
            font-variant-numeric: tabular-nums; letter-spacing: -0.5px;
        }
        .walk-stat .value .unit { font-size: 10px; font-weight: 600; color: var(--text-light); }
        .walk-stat .label {
            font-size: 10px; color: var(--text-light); margin-top: 3px; font-weight: 500;
            display: flex; align-items: center; justify-content: center; gap: 3px;
        }
        .walk-stat .label .material-symbols-sharp { font-size: 13px; }

        .walk-controls { display: flex; align-items: center; justify-content: center; gap: 20px; }
        .walk-ctrl-btn {
            border: none; cursor: pointer;
            display: flex; align-items: center; justify-content: center;
            font-family: inherit; transition: all 0.2s;
        }
        .walk-ctrl-btn:active { transform: scale(0.92); }
        .walk-ctrl-btn.pause {
            width: 50px; height: 50px; border-radius: 12px;
            background: var(--navy-mid);
        }
        .walk-ctrl-btn.pause .material-symbols-sharp { color: var(--white); font-size: 24px; }
        .walk-ctrl-btn.stop {
            width: 66px; height: 66px; border-radius: 12px;
            background: var(--orange);
            box-shadow: 0 4px 16px var(--orange-glow);
        }
        .walk-ctrl-btn.stop .material-symbols-sharp { color: var(--white); font-size: 28px; }
        .walk-ctrl-btn.camera {
            width: 50px; height: 50px; border-radius: 12px;
            background: var(--navy-mid);
        }
        .walk-ctrl-btn.camera .material-symbols-sharp { color: var(--white); font-size: 24px; }

        /* Walk screen start button */
        .walk-start-btn-screen {
            width: 100%; padding: 16px; border: none; border-radius: 8px;
            background: linear-gradient(135deg, var(--mint), var(--orange));
            color: var(--white); font-size: 16px; font-weight: 800;
            font-family: inherit; cursor: pointer;
            box-shadow: 0 6px 20px var(--mint-glow);
            transition: all 0.3s; text-transform: uppercase;
            letter-spacing: 1px;
            display: flex; align-items: center; justify-content: center; gap: 8px;
        }
        .walk-start-btn-screen .material-symbols-sharp { font-size: 22px; }
        .walk-start-btn-screen:hover { transform: translateY(-2px); box-shadow: 0 10px 28px var(--mint-glow); }

        /* ===== Result Modal (Dark Header) ===== */
        .result-modal {
            display: none; position: fixed; inset: 0; z-index: 400;
            background: rgba(0,0,0,0.6); align-items: flex-end; justify-content: center;
            max-width: 480px; margin: 0 auto;
        }
        .result-modal.active { display: flex; }
        .result-content {
            background: var(--white); border-radius: 20px 20px 0 0;
            width: 100%; max-height: 90vh; overflow-y: auto;
            animation: slideUp 0.3s ease;
        }
        @keyframes slideUp { from{transform:translateY(100%)} to{transform:translateY(0)} }
        .result-header-dark {
            background: var(--navy); padding: 28px 24px 20px;
            text-align: center; border-radius: 20px 20px 0 0;
        }
        .result-header-dark .celebration-icon {
            width: 56px; height: 56px; margin: 0 auto 12px;
            background: linear-gradient(135deg, var(--mint), var(--orange));
            border-radius: 12px;
            display: flex; align-items: center; justify-content: center;
        }
        .result-header-dark .celebration-icon .material-symbols-sharp {
            color: var(--white); font-size: 32px;
        }
        .result-header-dark h2 {
            font-size: 24px; font-weight: 900; color: var(--white);
            letter-spacing: -0.5px;
        }
        .result-header-dark p { font-size: 14px; color: var(--text-light); margin-top: 4px; }
        .result-body { padding: 20px 24px 36px; }
        .result-map-preview {
            width: 100%; height: 160px; border-radius: var(--radius);
            overflow: hidden; margin-bottom: 18px; background: var(--navy);
            border: 2px solid var(--navy);
        }
        .result-stats { display: grid; grid-template-columns: repeat(3,1fr); gap: 10px; margin-bottom: 20px; }
        .result-stat {
            background: var(--navy); border-radius: var(--radius);
            padding: 16px 8px; text-align: center;
        }
        .result-stat .icon-box {
            width: 28px; height: 28px; border-radius: 6px; margin: 0 auto 6px;
            display: flex; align-items: center; justify-content: center;
        }
        .result-stat .icon-box .material-symbols-sharp { font-size: 18px; }
        .result-stat .icon-box.dist { background: rgba(64,193,172,0.15); }
        .result-stat .icon-box.dist .material-symbols-sharp { color: var(--mint); }
        .result-stat .icon-box.time { background: rgba(176,212,241,0.2); }
        .result-stat .icon-box.time .material-symbols-sharp { color: var(--powder); }
        .result-stat .icon-box.cal { background: rgba(255,69,0,0.15); }
        .result-stat .icon-box.cal .material-symbols-sharp { color: var(--orange); }
        .result-stat .value { font-size: 20px; font-weight: 900; color: var(--white); letter-spacing: -0.5px; }
        .result-stat .label { font-size: 11px; color: var(--text-light); margin-top: 2px; }
        .result-badges { margin-bottom: 18px; }
        .result-badges h4 {
            font-size: 14px; font-weight: 800; margin-bottom: 8px;
            display: flex; align-items: center; gap: 6px;
        }
        .result-badges h4 .material-symbols-sharp { color: var(--orange); font-size: 20px; }
        .badge-list { display: flex; gap: 8px; flex-wrap: wrap; }
        .badge-item {
            display: inline-flex; align-items: center; gap: 5px;
            padding: 8px 16px;
            background: var(--navy); color: var(--mint);
            font-size: 12px; font-weight: 700;
            border-radius: 6px;
        }
        .result-actions { display: flex; gap: 12px; }
        .result-btn {
            flex: 1; padding: 14px; border-radius: 8px;
            font-size: 15px; font-weight: 700; font-family: inherit;
            cursor: pointer; border: none; transition: all 0.2s;
            text-transform: uppercase; letter-spacing: 0.5px;
        }
        .result-btn.share { background: var(--bg); color: var(--text); }
        .result-btn.save { background: var(--orange); color: white; box-shadow: 0 4px 12px var(--orange-glow); }
        .result-btn:hover { transform: translateY(-1px); }

        /* ===== Toast ===== */
        .toast-el {
            position: fixed; bottom: 90px; left: 50%;
            transform: translateX(-50%) translateY(12px);
            background: var(--navy); backdrop-filter: blur(8px);
            color: white; padding: 10px 20px; border-radius: 8px;
            font-size: 13px; font-weight: 600; z-index: 500;
            opacity: 0; transition: all 0.25s;
            pointer-events: none; white-space: nowrap; max-width: 90%;
            box-shadow: var(--shadow-lg);
            border-left: 3px solid var(--mint);
        }
        .toast-el.show { opacity: 1; transform: translateX(-50%) translateY(0); }

        /* ===== Animation ===== */
        .animate-in { animation: fadeInUp 0.4s ease forwards; opacity: 0; }
        @keyframes fadeInUp { from{opacity:0;transform:translateY(16px)} to{opacity:1;transform:translateY(0)} }
        .animate-in:nth-child(1) { animation-delay: 0.05s; }
        .animate-in:nth-child(2) { animation-delay: 0.1s; }
        .animate-in:nth-child(3) { animation-delay: 0.15s; }

        @media (max-width: 360px) {
            .weekly-stats .stat-value { font-size: 24px; }
            .walk-timer { font-size: 42px; }
        }
    </style>
</head>
<body>

    <!-- Header (Dark Navy) -->
    <header class="header">
        <div class="header-logo">
            <div class="logo-mark">
                <span class="material-symbols-sharp">pets</span>
            </div>
            <div class="logo-text">
                <span class="brand">Î©çÏù¥<em>Îûë</em></span>
                <span class="slogan">Ready, Set, Wag!</span>
            </div>
        </div>
        <div class="header-actions">
            <div class="gps-badge" id="gpsBadge">
                <span class="gps-dot"></span>
                <span id="gpsLabel">GPS ÎåÄÍ∏∞</span>
            </div>
            <button class="header-btn" aria-label="ÏïåÎ¶º">
                <span class="material-symbols-sharp">notifications</span>
                <span class="notification-dot"></span>
            </button>
        </div>
    </header>

    <!-- Main Content -->
    <main class="content">
        <!-- Weather (Dark + Mint Border) -->
        <div class="weather-bar animate-in">
            <div class="weather-info">
                <div class="weather-icon-box">
                    <span class="material-symbols-sharp">wb_sunny</span>
                </div>
                <div class="weather-text">
                    <h4>ÏÇ∞Ï±ÖÌïòÍ∏∞ Ï¢ãÏùÄ ÎÇ†Ïù¥ÏóêÏöî!</h4>
                    <p>ÎØ∏ÏÑ∏Î®ºÏßÄ Ï¢ãÏùå &middot; ÏäµÎèÑ 45%</p>
                </div>
            </div>
            <div class="weather-temp">12&deg;</div>
        </div>

        <!-- Weekly Summary (Dark Dashboard) -->
        <div class="weekly-card animate-in">
            <div class="weekly-header">
                <h3><span class="material-symbols-sharp">bar_chart</span> Ïù¥Î≤à Ï£º ÏÇ∞Ï±Ö</h3>
                <span class="period">2.3 ~ 2.9</span>
            </div>
            <div class="weekly-stats">
                <div class="stat-item">
                    <div class="stat-value">12.5<span class="unit">km</span></div>
                    <div class="stat-label">Ï¥ù Í±∞Î¶¨</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value">5<span class="unit">Ìöå</span></div>
                    <div class="stat-label">ÏÇ∞Ï±Ö ÌöüÏàò</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value">2:15</div>
                    <div class="stat-label">Ï¥ù ÏãúÍ∞Ñ</div>
                </div>
            </div>
            <div class="progress-section">
                <div class="progress-header">
                    <span>Ï£ºÍ∞Ñ Î™©Ìëú 20km</span>
                    <strong>62%</strong>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" style="width:62%"></div>
                </div>
            </div>
        </div>

        <!-- Walk Start (Split Two-Tone) -->
        <div class="walk-start-section animate-in">
            <button class="walk-start-btn-main" onclick="openWalkScreen()">
                <span class="btn-icon"><span class="material-symbols-sharp">pets</span></span>
                <div class="btn-content">
                    <div class="main-text">ÏÇ∞Ï±Ö ÏãúÏûë</div>
                    <div class="sub-text">Ï¥àÏΩîÏôÄ Ìï®Íªò Í±∏Ïñ¥Î≥ºÍπåÏöî?</div>
                </div>
                <span class="btn-arrow"><span class="material-symbols-sharp">arrow_forward</span></span>
            </button>
        </div>

        <!-- My Pets (Dark + Left Stripe) -->
        <div class="section-title">
            <h3><span class="material-symbols-sharp">pets</span> ÎÇ¥ Î∞òÎ†§ÎèôÎ¨º</h3>
            <a class="more" href="#">Í¥ÄÎ¶¨ <span class="material-symbols-sharp">chevron_right</span></a>
        </div>
        <div class="pets-scroll">
            <div class="pet-card selected" onclick="selectPet(this,'Ï¥àÏΩî')">
                <div class="pet-avatar dog">üêï</div>
                <h4>Ï¥àÏΩî</h4>
                <p>Í≥®Îì† Î¶¨Ìä∏Î¶¨Î≤Ñ &middot; 3ÏÇ¥</p>
                <div class="pet-stat">Ï¥ù 142.5km</div>
            </div>
            <div class="pet-card" onclick="selectPet(this,'ÎÇòÎπÑ')">
                <div class="pet-avatar cat">üêà</div>
                <h4>ÎÇòÎπÑ</h4>
                <p>ÏΩîÎ¶¨Ïïà ÏàèÌó§Ïñ¥ &middot; 2ÏÇ¥</p>
                <div class="pet-stat">Ï¥ù 28.3km</div>
            </div>
            <div class="pet-card">
                <div class="pet-avatar add"><span class="material-symbols-sharp">add</span></div>
                <h4 style="color:var(--text-light)">Ï∂îÍ∞ÄÌïòÍ∏∞</h4>
                <p>Î∞òÎ†§ÎèôÎ¨º Îì±Î°ù</p>
            </div>
        </div>

        <!-- Ranking (Sharp Angular) -->
        <div class="section-title">
            <h3><span class="material-symbols-sharp">emoji_events</span> ÎèôÎÑ§ Îû≠ÌÇπ</h3>
            <a class="more" href="#">Ï†ÑÏ≤¥Î≥¥Í∏∞ <span class="material-symbols-sharp">chevron_right</span></a>
        </div>
        <div class="ranking-card">
            <div class="ranking-tabs">
                <button class="ranking-tab active">Ï£ºÍ∞Ñ</button>
                <button class="ranking-tab">ÏõîÍ∞Ñ</button>
                <button class="ranking-tab">Ï†ÑÏ≤¥</button>
            </div>
            <div class="ranking-list">
                <div class="ranking-item">
                    <span class="rank-num rank-1">1</span>
                    <div class="rank-avatar">üêï</div>
                    <div class="rank-info">
                        <div class="rank-name">Ï¥àÏΩîÏïÑÎπ† <span class="rank-1-flame"><span class="material-symbols-sharp">local_fire_department</span></span></div>
                        <div class="rank-pet">Í≥®Îì† Î¶¨Ìä∏Î¶¨Î≤Ñ &middot; 4ÏÇ¥</div>
                    </div>
                    <div class="rank-distance">45.2 <span class="unit">km</span></div>
                </div>
                <div class="ranking-item me">
                    <span class="rank-num rank-2">2</span>
                    <div class="rank-avatar">üêï</div>
                    <div class="rank-info">
                        <div class="rank-name">ÎÇò <span class="material-symbols-sharp" style="font-size:14px;color:var(--orange)">star</span></div>
                        <div class="rank-pet">Í≥®Îì† Î¶¨Ìä∏Î¶¨Î≤Ñ &middot; 3ÏÇ¥</div>
                    </div>
                    <div class="rank-distance">38.1 <span class="unit">km</span></div>
                </div>
                <div class="ranking-item">
                    <span class="rank-num rank-3">3</span>
                    <div class="rank-avatar">üê©</div>
                    <div class="rank-info">
                        <div class="rank-name">Îã¨Ïù¥Îßò</div>
                        <div class="rank-pet">Ìë∏Îì§ &middot; 2ÏÇ¥</div>
                    </div>
                    <div class="rank-distance">32.7 <span class="unit">km</span></div>
                </div>
                <div class="ranking-item">
                    <span class="rank-num">4</span>
                    <div class="rank-avatar">üêï</div>
                    <div class="rank-info">
                        <div class="rank-name">Î∞îÎëëÏù¥ÏßëÏÇ¨</div>
                        <div class="rank-pet">ÏßÑÎèóÍ∞ú &middot; 5ÏÇ¥</div>
                    </div>
                    <div class="rank-distance">28.4 <span class="unit">km</span></div>
                </div>
                <div class="ranking-item">
                    <span class="rank-num">5</span>
                    <div class="rank-avatar">üêà</div>
                    <div class="rank-info">
                        <div class="rank-name">ÏΩ©Ïù¥ÏóÑÎßà</div>
                        <div class="rank-pet">Îü¨ÏãúÏïàÎ∏îÎ£® &middot; 3ÏÇ¥</div>
                    </div>
                    <div class="rank-distance">21.9 <span class="unit">km</span></div>
                </div>
            </div>
        </div>

        <!-- Challenges (Dark Cards + Neon Glow) -->
        <div class="section-title">
            <h3><span class="material-symbols-sharp">flag</span> ÏßÑÌñâ Ï§ëÏù∏ Ï±åÎ¶∞ÏßÄ</h3>
            <a class="more" href="#">Ï†ÑÏ≤¥Î≥¥Í∏∞ <span class="material-symbols-sharp">chevron_right</span></a>
        </div>
        <div class="challenge-scroll">
            <div class="challenge-item ch-dist">
                <div class="challenge-badge distance"><span class="material-symbols-sharp">route</span></div>
                <h4>Ï£ºÍ∞Ñ 50km Îã¨ÏÑ±</h4>
                <p>Ïù¥Î≤à Ï£º Ï¥ù 50km Í±∑Í∏∞</p>
                <div class="challenge-progress">
                    <div class="bar"><div class="bar-fill mint" style="width:76%"></div></div>
                    <span>38/50km</span>
                </div>
            </div>
            <div class="challenge-item ch-streak">
                <div class="challenge-badge streak"><span class="material-symbols-sharp">local_fire_department</span></div>
                <h4>7Ïùº Ïó∞ÏÜç ÏÇ∞Ï±Ö</h4>
                <p>Îß§Ïùº 1Ìöå Ïù¥ÏÉÅ ÏÇ∞Ï±Ö</p>
                <div class="challenge-progress">
                    <div class="bar"><div class="bar-fill orange" style="width:71%"></div></div>
                    <span>5/7Ïùº</span>
                </div>
            </div>
            <div class="challenge-item ch-explore">
                <div class="challenge-badge explore"><span class="material-symbols-sharp">explore</span></div>
                <h4>Í≥µÏõê ÌÉêÌóòÍ∞Ä</h4>
                <p>Îã§Î•∏ Í≥µÏõê 5Í≥≥ Î∞©Î¨∏</p>
                <div class="challenge-progress">
                    <div class="bar"><div class="bar-fill powder" style="width:40%"></div></div>
                    <span>2/5Í≥≥</span>
                </div>
            </div>
            <div class="challenge-item ch-energy">
                <div class="challenge-badge energy"><span class="material-symbols-sharp">bolt</span></div>
                <h4>ÏπºÎ°úÎ¶¨ Î≤ÑÎÑà</h4>
                <p>Ï£ºÍ∞Ñ ÏπºÎ°úÎ¶¨ 2000kcal ÏÜåÎ™®</p>
                <div class="challenge-progress">
                    <div class="bar"><div class="bar-fill gradient" style="width:65%"></div></div>
                    <span>1300/2000</span>
                </div>
            </div>
        </div>

        <!-- Nearby (Real Map) -->
        <div class="section-title">
            <h3><span class="material-symbols-sharp">location_on</span> ÎÇ¥ Ï£ºÎ≥Ä</h3>
            <a class="more" href="#">ÏßÄÎèÑÎ≥¥Í∏∞ <span class="material-symbols-sharp">chevron_right</span></a>
        </div>
        <div class="nearby-map-box" id="nearbyMap"></div>
        <div class="nearby-list">
            <div class="nearby-item type-park">
                <div class="nearby-icon park"><span class="material-symbols-sharp">park</span></div>
                <div class="nearby-info">
                    <div class="nearby-name">Î≥¥ÎùºÎß§Í≥µÏõê Î∞òÎ†§ÎèôÎ¨º ÎÜÄÏù¥ÌÑ∞</div>
                    <div class="nearby-detail">Î∞òÎ†§ÎèôÎ¨º Ï†ÑÏö© &middot; Î¨¥Î£å ÏûÖÏû•</div>
                </div>
                <div class="nearby-dist">450m</div>
            </div>
            <div class="nearby-item type-cafe">
                <div class="nearby-icon cafe"><span class="material-symbols-sharp">local_cafe</span></div>
                <div class="nearby-info">
                    <div class="nearby-name">Î©çÎ©çÏπ¥Ìéò</div>
                    <div class="nearby-detail">Î∞òÎ†§ÎèôÎ¨º ÎèôÎ∞ò Ïπ¥Ìéò &middot; ÎåÄÌòïÍ≤¨ OK</div>
                </div>
                <div class="nearby-dist">800m</div>
            </div>
            <div class="nearby-item type-hospital">
                <div class="nearby-icon hospital"><span class="material-symbols-sharp">local_hospital</span></div>
                <div class="nearby-info">
                    <div class="nearby-name">Ìï¥Ìîº ÎèôÎ¨ºÎ≥ëÏõê</div>
                    <div class="nearby-detail">24Ïãú ÏßÑÎ£å &middot; ÌèâÏ†ê 4.8</div>
                </div>
                <div class="nearby-dist">1.2km</div>
            </div>
        </div>

        <!-- Ad -->
        <div class="ad-banner">
            <span class="ad-badge">AD</span>
            <div class="ad-icon-box"><span class="material-symbols-sharp">redeem</span></div>
            <div class="ad-text">
                <h4>ÌîÑÎ¶¨ÎØ∏ÏóÑ Í∞ïÏïÑÏßÄ Í∞ÑÏãù 20% Ìï†Ïù∏!</h4>
                <p>ÏÇ∞Ï±Ö ÌõÑ ÎßõÏûàÎäî Í∞ÑÏãù Ïñ¥ÎïåÏöî?</p>
            </div>
        </div>

        <!-- Recent Walks -->
        <div class="section-title">
            <h3><span class="material-symbols-sharp">schedule</span> ÏµúÍ∑º ÏÇ∞Ï±Ö</h3>
            <a class="more" href="#">Ï†ÑÏ≤¥Î≥¥Í∏∞ <span class="material-symbols-sharp">chevron_right</span></a>
        </div>
        <div class="recent-walks">
            <div class="walk-item">
                <div class="walk-route-mini">
                    <svg viewBox="0 0 32 32" fill="none">
                        <path d="M6 26 L10 14 L18 18 L26 6" stroke="#40C1AC" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/>
                        <circle cx="6" cy="26" r="3" fill="#40C1AC"/>
                        <circle cx="26" cy="6" r="3" fill="#FF4500"/>
                    </svg>
                </div>
                <div class="walk-info">
                    <div class="walk-date">Ïò§Îäò Ïò§Ï†Ñ 7:30</div>
                    <div class="walk-title">Î≥¥ÎùºÎß§Í≥µÏõê ÏΩîÏä§</div>
                    <div class="walk-meta">
                        <span><span class="material-symbols-sharp">route</span> <strong>3.2km</strong></span>
                        <span><span class="material-symbols-sharp">timer</span> <strong>42Î∂Ñ</strong></span>
                        <span><span class="material-symbols-sharp">local_fire_department</span> <strong>165kcal</strong></span>
                    </div>
                </div>
            </div>
            <div class="walk-item">
                <div class="walk-route-mini">
                    <svg viewBox="0 0 32 32" fill="none">
                        <path d="M8 24 L16 8 L24 20" stroke="#40C1AC" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/>
                        <circle cx="8" cy="24" r="3" fill="#40C1AC"/>
                        <circle cx="24" cy="20" r="3" fill="#FF4500"/>
                    </svg>
                </div>
                <div class="walk-info">
                    <div class="walk-date">Ïñ¥Ï†ú Ïò§ÌõÑ 6:15</div>
                    <div class="walk-title">ÌïúÍ∞ï ÏÇ∞Ï±ÖÎ°ú</div>
                    <div class="walk-meta">
                        <span><span class="material-symbols-sharp">route</span> <strong>4.7km</strong></span>
                        <span><span class="material-symbols-sharp">timer</span> <strong>58Î∂Ñ</strong></span>
                        <span><span class="material-symbols-sharp">local_fire_department</span> <strong>231kcal</strong></span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Premium (Dark + Gradient Top) -->
        <div class="premium-banner">
            <div class="premium-icon-box"><span class="material-symbols-sharp">workspace_premium</span></div>
            <div class="premium-text">
                <h4>Î©çÏù¥Îûë ÌîÑÎ¶¨ÎØ∏ÏóÑ</h4>
                <p>Í¥ëÍ≥† Ï†úÍ±∞ + ÏÉÅÏÑ∏ ÌÜµÍ≥Ñ + Î¨¥Ï†úÌïú Ï±åÎ¶∞ÏßÄ</p>
            </div>
            <div class="premium-price">
                <div class="price">&yen;3,900</div>
                <div class="period">/Ïõî</div>
            </div>
        </div>
        <div style="height:24px"></div>
    </main>

    <!-- Bottom Nav (Dark, Square Center) -->
    <nav class="bottom-nav">
        <button class="nav-item active" onclick="switchTab(this)">
            <span class="nav-icon"><span class="material-symbols-sharp">home</span></span>
            <span class="nav-label">Ìôà</span>
        </button>
        <button class="nav-item" onclick="switchTab(this)">
            <span class="nav-icon"><span class="material-symbols-sharp">group</span></span>
            <span class="nav-label">ÏÜåÏÖú</span>
        </button>
        <button class="nav-item center-btn" onclick="openWalkScreen()">
            <span class="nav-icon"><span class="material-symbols-sharp">pets</span></span>
            <span class="nav-label">ÏÇ∞Ï±Ö</span>
        </button>
        <button class="nav-item" onclick="switchTab(this)">
            <span class="nav-icon"><span class="material-symbols-sharp">emoji_events</span></span>
            <span class="nav-label">Îû≠ÌÇπ</span>
        </button>
        <button class="nav-item" onclick="switchTab(this)">
            <span class="nav-icon"><span class="material-symbols-sharp">person</span></span>
            <span class="nav-label">MY</span>
        </button>
    </nav>

    <!-- ===== Walk Screen ===== -->
    <div class="walk-screen" id="walkScreen">
        <div class="walk-screen-header">
            <div class="gps-badge" id="walkGpsBadge">
                <span class="gps-dot"></span>
                <span id="walkGpsLabel">GPS</span>
            </div>
            <h3 id="walkScreenTitle"><span class="material-symbols-sharp">pets</span> ÏÇ∞Ï±Ö Ï§ÄÎπÑ</h3>
            <button class="walk-close-btn" onclick="closeWalk()">
                <span class="material-symbols-sharp">close</span>
            </button>
        </div>

        <div class="walk-map-area">
            <div id="walkMap"></div>
            <div class="walk-map-controls">
                <button class="wmap-btn" onclick="centerMe()" title="ÎÇ¥ ÏúÑÏπò">
                    <span class="material-symbols-sharp">my_location</span>
                </button>
                <button class="wmap-btn on" id="followBtn" onclick="toggleFollow()" title="Îî∞ÎùºÍ∞ÄÍ∏∞">
                    <span class="material-symbols-sharp">gps_fixed</span>
                </button>
                <button class="wmap-btn" onclick="wMap.zoomIn()">
                    <span class="material-symbols-sharp">add</span>
                </button>
                <button class="wmap-btn" onclick="wMap.zoomOut()">
                    <span class="material-symbols-sharp">remove</span>
                </button>
            </div>
            <div class="walk-dist-chip" id="walkDistChip" style="display:none">
                <span class="live-dot"></span>
                <span class="dist-num" id="mapDistNum">0.00</span>
                <span class="dist-unit">km</span>
            </div>
        </div>

        <div class="walk-stats-panel">
            <div class="walk-pet-label" id="walkPetLabel">
                <span class="material-symbols-sharp">pets</span> Ï¥àÏΩîÏôÄ ÏÇ∞Ï±Ö
            </div>
            <div class="walk-pause-label" id="walkPauseLabel">
                <span class="material-symbols-sharp">pause</span> ÏùºÏãúÏ†ïÏßÄ
            </div>
            <div class="walk-timer" id="walkTimer">00:00:00</div>
            <div class="walk-stats-grid">
                <div class="walk-stat">
                    <div class="value"><span id="wDist">0.00</span> <span class="unit">km</span></div>
                    <div class="label"><span class="material-symbols-sharp">route</span> Í±∞Î¶¨</div>
                </div>
                <div class="walk-stat">
                    <div class="value"><span id="wCal">0</span> <span class="unit">kcal</span></div>
                    <div class="label"><span class="material-symbols-sharp">local_fire_department</span> ÏπºÎ°úÎ¶¨</div>
                </div>
            </div>
            <div class="walk-controls" id="preStartControls">
                <button class="walk-start-btn-screen" onclick="beginTracking()">
                    <span class="material-symbols-sharp">pets</span> GPS ÏÇ∞Ï±Ö ÏãúÏûë!
                </button>
            </div>
            <div class="walk-controls" id="walkingControls" style="display:none">
                <button class="walk-ctrl-btn pause" id="pauseBtn" onclick="togglePause()">
                    <span class="material-symbols-sharp">pause</span>
                </button>
                <button class="walk-ctrl-btn stop" onclick="stopWalk()">
                    <span class="material-symbols-sharp">stop</span>
                </button>
                <button class="walk-ctrl-btn camera" onclick="toast('ÏÇ¨ÏßÑ Ï¥¨ÏòÅ!')">
                    <span class="material-symbols-sharp">photo_camera</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Result Modal (Dark Header) -->
    <div class="result-modal" id="resultModal">
        <div class="result-content">
            <div class="result-header-dark">
                <div class="celebration-icon">
                    <span class="material-symbols-sharp">emoji_events</span>
                </div>
                <h2>ÏÇ∞Ï±Ö ÏôÑÎ£å!</h2>
                <p id="resultPetMsg">Ï¥àÏΩîÏôÄ Ï¶êÍ±∞Ïö¥ ÏÇ∞Ï±ÖÏù¥ÏóàÏñ¥Ïöî</p>
            </div>
            <div class="result-body">
                <div class="result-map-preview" id="resultMapEl"></div>
                <div class="result-stats">
                    <div class="result-stat">
                        <div class="icon-box dist"><span class="material-symbols-sharp">route</span></div>
                        <div class="value" id="rDist">0 km</div>
                        <div class="label">Í±∞Î¶¨</div>
                    </div>
                    <div class="result-stat">
                        <div class="icon-box time"><span class="material-symbols-sharp">timer</span></div>
                        <div class="value" id="rTime">0:00</div>
                        <div class="label">ÏãúÍ∞Ñ</div>
                    </div>
                    <div class="result-stat">
                        <div class="icon-box cal"><span class="material-symbols-sharp">local_fire_department</span></div>
                        <div class="value" id="rCal">0 kcal</div>
                        <div class="label">ÏπºÎ°úÎ¶¨</div>
                    </div>
                </div>
                <div class="result-badges" id="resBadges" style="display:none">
                    <h4><span class="material-symbols-sharp">military_tech</span> ÌöçÎìùÌïú Î∞∞ÏßÄ</h4>
                    <div class="badge-list" id="badgeList"></div>
                </div>
                <div class="result-actions">
                    <button class="result-btn share" onclick="closeResult()">Îã´Í∏∞</button>
                    <button class="result-btn save" onclick="saveAndClose()">Ï†ÄÏû•ÌïòÍ∏∞</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast -->
    <div class="toast-el" id="toastEl"></div>

    <script>
    // ============================================================
    //  Î©çÏù¥Îûë (withbowwow) - Ïª®ÏÖâ2: Urban Sporty
    //  "ÎèÑÏã¨ ÏÜçÏùÑ Í∞ÄÎ°úÏßÄÎ•¥Îäî ÏóêÎÑàÏ†úÌã±Ìïú Î∞úÍ±∏Ïùå"
    //  OpenStreetMap + Leaflet.js | Material Symbols Sharp
    // ============================================================

    // --- State ---
    let curPos = null;
    let curAcc = null;
    let selectedPet = 'Ï¥àÏΩî';
    let nearbyMapObj = null;
    let nearbyMarker = null;
    let wMap = null;
    let wMarker = null;
    let wAccCircle = null;
    let wPolyline = null;
    let wStartMarker = null;
    let resMapObj = null;

    let follow = true;
    let walking = false;
    let paused = false;
    let secs = 0;
    let dist = 0;
    let route = [];
    let tickId = null;
    let gpsWatchId = null;

    // --- Haversine ---
    function hav(lat1,lon1,lat2,lon2){
        const R=6371000, toR=d=>d*Math.PI/180;
        const dLat=toR(lat2-lat1), dLon=toR(lon2-lon1);
        const a=Math.sin(dLat/2)**2 + Math.cos(toR(lat1))*Math.cos(toR(lat2))*Math.sin(dLon/2)**2;
        return R*2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a));
    }

    // --- Leaflet marker icon (angular diamond style) ---
    function makeDot(color, size){
        return L.divIcon({
            html:'<div style="width:'+size+'px;height:'+size+'px;background:'+color+';border:3px solid white;border-radius:4px;box-shadow:0 2px 8px rgba(0,0,0,0.35);transform:rotate(45deg)"></div>',
            iconSize:[size,size], iconAnchor:[size/2,size/2], className:''
        });
    }

    // --- Init nearby mini-map ---
    function initNearbyMap(lat, lng){
        if(nearbyMapObj) return;
        nearbyMapObj = L.map('nearbyMap',{zoomControl:false, attributionControl:true, dragging:true}).setView([lat,lng],15);
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{maxZoom:19,attribution:'&copy; OSM'}).addTo(nearbyMapObj);
        nearbyMarker = L.marker([lat,lng],{icon:makeDot('#40C1AC',16)}).addTo(nearbyMapObj);
    }

    // --- Init walk map ---
    function initWalkMap(lat, lng){
        if(wMap){
            wMap.setView([lat,lng],17);
            wMarker.setLatLng([lat,lng]);
            wAccCircle.setLatLng([lat,lng]);
            return;
        }
        wMap = L.map('walkMap',{zoomControl:false, attributionControl:false}).setView([lat,lng],17);
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{maxZoom:19}).addTo(wMap);

        wMarker = L.marker([lat,lng],{icon:makeDot('#FF4500',20)}).addTo(wMap);
        wAccCircle = L.circle([lat,lng],{
            radius:30, color:'#40C1AC', fillColor:'#40C1AC',
            fillOpacity:0.08, weight:1, opacity:0.3
        }).addTo(wMap);
        wPolyline = L.polyline([],{
            color:'#40C1AC', weight:5, opacity:0.85,
            lineJoin:'round', lineCap:'round'
        }).addTo(wMap);
    }

    // --- GPS ---
    function initGPS(){
        if(!navigator.geolocation){
            toast('GPSÎ•º ÏßÄÏõêÌïòÏßÄ ÏïäÎäî Î∏åÎùºÏö∞Ï†ÄÏûÖÎãàÎã§');
            return;
        }

        navigator.geolocation.getCurrentPosition(
            p=>{
                const {latitude:lat, longitude:lng, accuracy}=p.coords;
                curPos={lat,lng}; curAcc=accuracy;
                setGPS(true);
                initNearbyMap(lat,lng);
                toast('ÌòÑÏû¨ ÏúÑÏπòÎ•º Ï∞æÏïòÏäµÎãàÎã§');
            },
            e=>{
                setGPS(false);
                initNearbyMap(37.5665,126.978);
                toast('GPS: '+e.message);
            },
            {enableHighAccuracy:true, timeout:15000, maximumAge:5000}
        );

        gpsWatchId = navigator.geolocation.watchPosition(
            p=>{
                const {latitude:lat, longitude:lng, accuracy}=p.coords;
                const newPos={lat,lng};

                if(walking && !paused && curPos){
                    const d=hav(curPos.lat,curPos.lng,lat,lng);
                    if(d>=2 && accuracy<50){
                        dist+=d;
                        route.push({lat,lng,t:Date.now()});
                        if(wPolyline) wPolyline.addLatLng([lat,lng]);
                    }
                }

                curPos=newPos; curAcc=accuracy;
                setGPS(true);

                if(nearbyMarker) nearbyMarker.setLatLng([lat,lng]);
                if(wMarker){
                    wMarker.setLatLng([lat,lng]);
                    wAccCircle.setLatLng([lat,lng]).setRadius(accuracy);
                    if(follow && wMap) wMap.panTo([lat,lng]);
                }
            },
            e=>{ setGPS(false); },
            {enableHighAccuracy:true, maximumAge:3000, timeout:10000}
        );
    }

    function setGPS(on){
        ['gpsBadge','walkGpsBadge'].forEach(id=>{
            const el=document.getElementById(id);
            if(el) el.classList.toggle('on',on);
        });
        document.getElementById('gpsLabel').textContent = on?'GPS ÌôúÏÑ±':'GPS Ïò§Î•ò';
        const wl=document.getElementById('walkGpsLabel');
        if(wl) wl.textContent = on ? (curAcc?'\u00B1'+Math.round(curAcc)+'m':'GPS') : 'GPS Ïò§Î•ò';
    }

    // --- Walk Screen ---
    function openWalkScreen(){
        const ws = document.getElementById('walkScreen');
        ws.classList.add('active');

        document.getElementById('preStartControls').style.display='flex';
        document.getElementById('walkingControls').style.display='none';
        document.getElementById('walkDistChip').style.display='none';
        document.getElementById('walkPauseLabel').classList.remove('on');
        document.getElementById('walkTimer').textContent='00:00:00';
        document.getElementById('wDist').textContent='0.00';
        document.getElementById('wCal').textContent='0';
        document.getElementById('walkScreenTitle').innerHTML=
            '<span class="material-symbols-sharp">pets</span> ÏÇ∞Ï±Ö Ï§ÄÎπÑ';
        document.getElementById('walkPetLabel').innerHTML=
            '<span class="material-symbols-sharp">pets</span> '+selectedPet+'ÏôÄ ÏÇ∞Ï±Ö';

        setTimeout(function(){
            var lat = curPos ? curPos.lat : 37.5665;
            var lng = curPos ? curPos.lng : 126.978;
            initWalkMap(lat, lng);
            setTimeout(function(){ if(wMap) wMap.invalidateSize(); },100);
        }, 50);
    }

    function beginTracking(){
        if(!curPos){ toast('GPS ÏúÑÏπòÎ•º Î®ºÏ†Ä ÌôïÏù∏Ìï¥Ï£ºÏÑ∏Ïöî'); return; }

        walking=true; paused=false; secs=0; dist=0;
        route=[{lat:curPos.lat, lng:curPos.lng, t:Date.now()}];

        if(wPolyline) wPolyline.setLatLngs([[curPos.lat,curPos.lng]]);
        if(wStartMarker) wMap.removeLayer(wStartMarker);
        wStartMarker = L.circleMarker([curPos.lat,curPos.lng],{
            radius:8, color:'#fff', fillColor:'#40C1AC', fillOpacity:1, weight:3
        }).addTo(wMap);

        document.getElementById('preStartControls').style.display='none';
        document.getElementById('walkingControls').style.display='flex';
        document.getElementById('walkDistChip').style.display='flex';
        document.getElementById('walkScreenTitle').innerHTML=
            '<span class="material-symbols-sharp">pets</span> '+selectedPet+'ÏôÄ ÏÇ∞Ï±Ö Ï§ë';

        wMap.setZoom(18);

        tickId = setInterval(function(){
            if(!paused){
                secs++;
                updateWalkUI();
            }
        },1000);

        toast(selectedPet+'ÏôÄ(Í≥º) ÏÇ∞Ï±ÖÏùÑ ÏãúÏûëÌï©ÎãàÎã§!');
    }

    function togglePause(){
        paused=!paused;
        var btn = document.getElementById('pauseBtn');
        btn.innerHTML = paused
            ? '<span class="material-symbols-sharp">play_arrow</span>'
            : '<span class="material-symbols-sharp">pause</span>';
        document.getElementById('walkPauseLabel').classList.toggle('on',paused);
        toast(paused ? 'ÏùºÏãúÏ†ïÏßÄ' : 'ÏÇ∞Ï±Ö Ïû¨Í∞ú');
    }

    function stopWalk(){
        if(secs<3){ toast('Ï°∞Í∏àÎßå Îçî Í±∏Ïñ¥Î≥¥ÏÑ∏Ïöî!'); return; }
        if(!confirm('ÏÇ∞Ï±ÖÏùÑ Ï¢ÖÎ£åÌïòÏãúÍ≤†ÏäµÎãàÍπå?')) return;

        walking=false; paused=false;
        clearInterval(tickId);

        var km=dist/1000;
        var cal=Math.round(km*55);
        var mm=Math.floor(secs/60), ss=secs%60;

        document.getElementById('rDist').textContent=km.toFixed(2)+' km';
        document.getElementById('rTime').textContent=mm+'\uBD84 '+ss+'\uCD08';
        document.getElementById('rCal').textContent=cal+' kcal';
        document.getElementById('resultPetMsg').textContent=selectedPet+'ÏôÄ(Í≥º) Ï¶êÍ±∞Ïö¥ ÏÇ∞Ï±ÖÏù¥ÏóàÏñ¥Ïöî';

        // Badges (no speed badge)
        var badges=[];
        if(km>=1) badges.push('1km Îã¨ÏÑ±');
        if(km>=3) badges.push('3km Îã¨ÏÑ±');
        if(km>=5) badges.push('5km Îã¨ÏÑ±');
        if(mm>=30) badges.push('30Î∂Ñ ÏÇ∞Ï±Ö');
        if(mm>=60) badges.push('1ÏãúÍ∞Ñ ÏÇ∞Ï±Ö');
        if(km>=10) badges.push('\u26A1 10km Îã¨ÏÑ±');
        var bd=document.getElementById('resBadges'), bl=document.getElementById('badgeList');
        if(badges.length>0){
            bd.style.display='block';
            bl.innerHTML=badges.map(function(b){return '<span class="badge-item">'+b+'</span>';}).join('');
        } else { bd.style.display='none'; }

        document.getElementById('walkScreen').classList.remove('active');
        document.getElementById('resultModal').classList.add('active');
        setTimeout(function(){buildResultMap();},300);

        // Save to localStorage (no speed)
        var h=JSON.parse(localStorage.getItem('withbowwow_walks')||'[]');
        h.unshift({
            pet: selectedPet,
            distance: km,
            duration: secs,
            calories: cal,
            route: route,
            date: new Date().toISOString()
        });
        if(h.length>50) h.pop();
        localStorage.setItem('withbowwow_walks', JSON.stringify(h));
    }

    function closeWalk(){
        if(walking){
            if(confirm('ÏÇ∞Ï±ÖÏùÑ Ï¢ÖÎ£åÌïòÏãúÍ≤†ÏäµÎãàÍπå?')) stopWalk();
        } else {
            document.getElementById('walkScreen').classList.remove('active');
        }
    }

    function updateWalkUI(){
        var hh=String(Math.floor(secs/3600)).padStart(2,'0');
        var mm=String(Math.floor((secs%3600)/60)).padStart(2,'0');
        var ss=String(secs%60).padStart(2,'0');
        document.getElementById('walkTimer').textContent=hh+':'+mm+':'+ss;

        var km=dist/1000;
        var cal=Math.round(km*55);
        document.getElementById('wDist').textContent=km.toFixed(2);
        document.getElementById('wCal').textContent=cal;
        document.getElementById('mapDistNum').textContent=km.toFixed(2);
    }

    // --- Result Map ---
    function buildResultMap(){
        if(route.length<2) return;
        var el=document.getElementById('resultMapEl');
        if(resMapObj){resMapObj.remove();resMapObj=null;}
        resMapObj=L.map(el,{zoomControl:false,attributionControl:false,dragging:false});
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{maxZoom:19}).addTo(resMapObj);
        var pts=route.map(function(r){return [r.lat,r.lng];});
        L.polyline(pts,{color:'#40C1AC',weight:4}).addTo(resMapObj);
        L.circleMarker(pts[0],{radius:7,color:'#fff',fillColor:'#40C1AC',fillOpacity:1,weight:3}).addTo(resMapObj);
        L.circleMarker(pts[pts.length-1],{radius:7,color:'#fff',fillColor:'#FF4500',fillOpacity:1,weight:3}).addTo(resMapObj);
        resMapObj.fitBounds(L.latLngBounds(pts),{padding:[30,30]});
    }

    // --- Map helpers ---
    function centerMe(){
        if(curPos&&wMap){ wMap.setView([curPos.lat,curPos.lng],17); toast('ÎÇ¥ ÏúÑÏπò'); }
    }
    function toggleFollow(){
        follow=!follow;
        document.getElementById('followBtn').classList.toggle('on',follow);
        toast(follow?'Îî∞ÎùºÍ∞ÄÍ∏∞ ON':'Îî∞ÎùºÍ∞ÄÍ∏∞ OFF');
    }

    // --- UI helpers ---
    function selectPet(el,name){
        document.querySelectorAll('.pet-card').forEach(function(c){c.classList.remove('selected');});
        el.classList.add('selected');
        selectedPet=name;
    }
    function switchTab(el){
        document.querySelectorAll('.nav-item').forEach(function(i){i.classList.remove('active');});
        el.classList.add('active');
    }
    function closeResult(){
        document.getElementById('resultModal').classList.remove('active');
        if(resMapObj){resMapObj.remove();resMapObj=null;}
    }
    function saveAndClose(){
        toast('ÏÇ∞Ï±Ö Í∏∞Î°ùÏù¥ Ï†ÄÏû•ÎêòÏóàÏäµÎãàÎã§');
        closeResult();
    }

    // Ranking tabs
    document.querySelectorAll('.ranking-tab').forEach(function(tab){
        tab.addEventListener('click',function(){
            document.querySelectorAll('.ranking-tab').forEach(function(t){t.classList.remove('active');});
            tab.classList.add('active');
        });
    });

    // Toast
    var toastTimer;
    function toast(msg){
        var el=document.getElementById('toastEl');
        el.textContent=msg; el.classList.add('show');
        clearTimeout(toastTimer);
        toastTimer=setTimeout(function(){el.classList.remove('show');},2500);
    }

    // --- Init ---
    initGPS();
    </script>
</body>
</html>